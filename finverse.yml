swagger: "2.0"

info:
  version: 0.0.1
  title: Finverse Public
  description: Documentation of the early finverse services
  termsOfService: https://example.com
  contact:
    name: Maintainers
    email: info@finverse.com
  license:
    name: "unknown license"

host: api.prod.finverse.net
basePath: /
schemes:
  - https
consumes:
  - application/json
produces:
  - application/json

securityDefinitions:
  Oauth2:
    type: oauth2
    flow: application
    tokenUrl: "https://finverse-dev.us.auth0.com/oauth/token"
    scopes:
      test: Test
      account: Account
      balance: Balance
      transaction: Transaction
      credit: Credit
      investment: Investment
      institution: Institution
      link: Link

security:
  - Oauth2:
      - test

tags:
  - description: Operations does not required an access token
    name: public
  - description: Operations required a customer access token
    name: customer
  - description: Operations required a login identity access token
    name: login_identity
  - description: Operations required a link token
    name: link

definitions:
  Principal:
    type: object
    properties:
      subject:
        type: string
        example: could be clientId/customerAppId/loginIdentityId depends on the type of token, see also the explict claims for each of these ids
      token:
        type: string
        example: algorithm.claims.hmac
      client_id:
        type: string
        example: someClientId
      customer_app_id:
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      login_identity_id:
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      customization_id:
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      mandate_id:
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      expires_in:
        type: number
        example: 3600
      payment_attempt_id: # This will be populated if its a token for payment link
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      payment_id: 
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      product_flow:
        type: string
        example: PAYMENT_LINK
      scopes:
        type: array
        items:
          type: string
        example: ["link", "transaction"]
      link_token_request:
        $ref: "#/definitions/LinkTokenRequest"
      get_mandate_auth_link_request:
        $ref: "#/definitions/GetMandateAuthLinkRequest"
      currency:
        type: string

      # Some Payment Link specific stuffs
      redirect_uri:
        type: string
      payment_link_id:
        type: string
      unique_reference_id:
        type: string
      payment_method_id:
        type: string
      tpp_name:
        type: string
      retry_url:
        type: string
      onboarding_flow:
        type: string

      # Some FPS token specific stuffs
      qr_code_text:
        type: string
        description: The qrCode text to be used to generate the image
      manual_payment_provider:
        type: string
        example: ["HK_FPS", "SG_PAYNOW"]

    required:
      - "customer_app_id"
      - "login_identity_id"
      - "client_id"
      - "subject"

  GetAccountResponse:
    properties:
      account:
        $ref: "#/definitions/Account"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"

  ListCardsDetailsResponse:
    properties:
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"
      card_details:
        $ref: "#/definitions/CardDetails"

  GetAccountNumberResponse:
    properties:
      account_number:
        $ref: "#/definitions/AccountNumber"
      account:
        $ref: "#/definitions/Account"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"
      payment_details:
        type: array
        items:
          $ref: "#/definitions/PaymentDetails"

  GetBalanceHistoryResponse:
    properties:
      account:
        $ref: "#/definitions/Account"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"
      balance_history:
        type: array
        items:
          $ref: "#/definitions/BalanceHistory"
      source:
        type: string
        enum: [INSTITUTION, COMPUTED]

  GetIdentityResponse:
    properties:
      identity:
        $ref: "#/definitions/Identity"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"

  Identity:
    properties:
      names:
        type: array
        items:
          $ref: "#/definitions/IdentityName"
      addresses:
        type: array
        items:
          $ref: "#/definitions/IdentityAddress"
      emails:
        type: array
        items:
          $ref: "#/definitions/IdentityEmail"
      phone_numbers:
        type: array
        items:
          $ref: "#/definitions/IdentityPhoneNumber"
      date_of_births:
        type: array
        items:
          $ref: "#/definitions/IdentityDateOfBirth"

  ListAccountsResponse:
    properties:
      accounts:
        type: array
        items:
          $ref: "#/definitions/Account"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"

  RefreshRequest:
    properties:
      refresh_token:
        type: string
    required:
      - "refresh_token"

  Account:
    properties:
      account_id:
        type: string
        example: "01ARZ3NDEKTSV4RRFFQ69G5FAV"
      group_id:
        type: string
        example: "03504faef9ad3ac048c6a43efa6db7ba1c5239a856536839d87ac949559e7ceb"
        description: The SHA3-256 hash of the account number, salted with the loginIdentityId
      account_holder_name:
        type: string
        example: John Doe
      account_name:
        type: string
        example: HKD Savings
      account_nickname:
        type: string
        example: Emergency Fund
      account_sub_type:
        type: string
        example: TIME_DEPOSIT
      account_number_masked:
        type: string
        example: 123XXXXXX89
      country:
        type: string
        example: HKG
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
      account_currency:
        type: string
        example: "HKD"
      balance:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      statement_balance:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      is_parent:
        type: boolean
        example: false
      is_closed:
        type: boolean
        example: false
      is_excluded:
        type: boolean
        example: false
      account_type:
        type: object
        $ref: "#/definitions/AccountType"
      metadata:
        type: object
        additionalProperties:
          type: string
    required:
      - is_parent
      - is_closed
      - is_excluded
      - account_id
      - account_name
      - group_id
      - metadata

  BalanceHistory:
    properties:
      date:
        type: string
        example: "2021-10-27"
        description: The date the balance was recorded
      amount:
        type: number
        example: 69.00
        description: The end of day balance for this account on this specific date
      currency:
        type: string
        example: "HKD"
        description: The currency the balance
    required:
      - date
      - amount
      - currency

  AccountNumber:
    properties:
      account_id:
        type: string
        example: "01ARZ3NDEKTSV4RRFFQ69G5FAV"
      number:
        type: string
        example: "1234567890123"
      raw:
        type: string
        example: "123-4567890-123"
    required:
      - account_id
      - raw

  GenericAmount:
    properties:
      unit:
        type: string
        example: "UNI$"
      value:
        type: number
        example: 69.00
      raw:
        type: string
        example: "69.00"
    required:
      - value

  CurrencyAmount:
    properties:
      currency:
        type: string
        example: "HKD"
      value:
        type: number
        example: 69.00
      raw:
        type: string
        example: "69.00"
    required:
      - value

  Transaction:
    properties:
      transaction_id:
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      account_id:
        type: string
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      transaction_state:
        type: string
        example: ACTIVE
      transaction_type:
        type: string
        example: OTHER
      category:
        type: string
        example: OTHER
        description: (Deprecated)
      category_id:
        type: string
        example: OTHER
        description: (Deprecated)
      merchant_name:
        type: string
        example: FUEL COFFEE
      description:
        type: string
        example: Latte
      location:
        type: string
        example: Pacific Place
      is_pending:
        type: boolean
        example: false
      status:
        type: string
        example: COMPLETED
      posted_date:
        type: string
        description: YYYY-MM-DD
        example: 2020-10-10
      amount:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      running_balance:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      transaction_details:
        type: object
        description: Transaction Details
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
      categories:
        type: array
        description: Array of category labels
        items:
          type: string
        example: ["TRANSFER"]
      transaction_time:
        type: string
        format: date-time
        description: Optional field indicating when the transaction happened
        x-nullable: true
      transaction_reference:
        type: string
        description: Transaction reference provided by the bank
      category_predictions:
        type: array
        items:
          $ref: "#/definitions/categoryPredictions"
    required:
      - is_pending

  categoryPredictions:
    type: object
    properties:
      categories:
        type: array
        items:
          type: string
        example: ["TRANSFER"]
      source:
        type: string
        example: TRANSACTION_RULES
      source_id:
        type: string

  ListTransactionsResponse:
    properties:
      accounts:
        type: array
        items:
          $ref: "#/definitions/Account"
      transactions:
        type: array
        items:
          $ref: "#/definitions/Transaction"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"
      total_transactions:
        type: integer
    required:
      - total_transactions

  ListInstitutionsResponse:
    type: array
    items:
      $ref: "#/definitions/Institution"

  #Identity Subtypes
  IdentityName:
    type: object
    properties:
      raw:
        type: string
        example: "John Maximus Doe"
      full_name:
        type: string
        example: "John Maximus Doe"
      first_name:
        type: string
        example: "John"
      last_name:
        type: string
        example: "Doe"
      other_name:
        type: string
        example: "Maximus"
      source:
        type: string
        example: "INTERNET_BANKING"
      source_ids:
        type: array
        items:
          type: string
      account_ids:
        type: array
        items:
          type: string
  IdentityAddress:
    type: object
    properties:
      raw:
        type: string
        example: "221B Baker Street, Westminster, London"
      full_address:
        type: string
        example: "221B Baker Street, Westminster, London"
      unit_number:
        type: string
        example: "221B"
      floor_number:
        type: string
        example: "2"
      building_name:
        type: string
        example: "Building A"
      street_number:
        type: string
        example: "221B"
      street_name:
        type: string
        example: "Baker Street"
      city:
        type: string
        example: "London"
      district:
        type: string
        example: "Marleybone"
      ward:
        type: string
        example: "Sheung Wan"
      street_address:
        type: string
        example: "221B Baker Street"
      province:
        type: string
        example: "Westminster"
      country:
        type: string
        example: "United Kingdom"
      postal_code:
        type: string
        example: "NW1 6XE"
      source:
        type: string
        example: "INTERNET_BANKING"
      source_ids:
        type: array
        items:
          type: string
      account_ids:
        type: array
        items:
          type: string
  IdentityEmail:
    type: object
    properties:
      raw:
        type: string
        example: "example123@example.com"
      email:
        type: string
        example: "example123@example.com"
      masked_email:
        type: string
        example: "exam******@example.com"
      source:
        type: string
        example: "INTERNET_BANKING"
      source_ids:
        type: array
        items:
          type: string
      account_ids:
        type: array
        items:
          type: string
  IdentityPhoneNumber:
    type: object
    properties:
      raw:
        type: string
        example: "+123 4567 8901"
      mobile_phone:
        type: string
        example: "+12345678901"
      other_phone:
        type: string
        example: "+12345678901"
      masked_phone:
        type: string
        example: "+12345****01"
      source:
        type: string
        example: "INTERNET_BANKING"
      source_ids:
        type: array
        items:
          type: string
      account_ids:
        type: array
        items:
          type: string
  IdentityDateOfBirth:
    type: object
    properties:
      raw:
        type: string
        example: "1999-01-22"
      date_of_birth:
        type: string
        example: "1999-01-22"
      masked_date_of_birth:
        type: string
        example: "XXXX-01-22"
      source:
        type: string
        example: "INTERNET_BANKING"
      source_ids:
        type: array
        items:
          type: string
      account_ids:
        type: array
        items:
          type: string

  InstitutionShort:
    properties:
      institution_id:
        type: string
        example: 123
      countries:
        type: array
        example: [HKG]
        items:
          type: string
      institution_name:
        type: string
        example: Mock Bank
      portal_name:
        type: string
        example: Personal Internet Banking

  Institution:
    properties:
      institution_id:
        type: string
        example: 123
      countries:
        type: array
        example: [HKG]
        items:
          type: string
      tags:
        type: array
        example: ["real"]
        items:
          type: string
          enum: [real, test]
      institution_type:
        type: string
        example: BANK
        enum: &INSTITUTION_TYPE [BANK, WALLET, TEST]
      products_supported:
        type: array
        example: [ACCOUNTS, TRANSACTIONS, STATEMENTS, ACCOUNT_NUMBERS, IDENTITY, AUTO_DEBIT_SETUP]
        items:
          type: string
          enum: [ACCOUNTS, TRANSACTIONS, STATEMENTS, ACCOUNT_NUMBERS, IDENTITY, AUTO_DEBIT_SETUP]
      parent_institution_name:
        type: string
        example: Parent Mock Bank
      institution_name:
        type: string
        example: Mock Bank
      portal_name:
        type: string
        example: Personal Internet Banking
      user_type:
        type: array
        items:
          type: string
          example: INDIVIDUAL
          enum: [PERSONAL, INDIVIDUAL, BUSINESS]
      status:
        type: string
        enum: [SUPPORTED, ALPHA, BETA]
        example: SUPPORTED
      status_details:
        type: object
        example: {}
      login_url:
        type: string
        example: "https://example.com/login"
      login_details:
        x-go-type:
          type: LoginDetails
          import:
            package: gitlab.com/finverse/gitops/applications/api/models/custom
      login_methods:
        type: array
        items:
          type: object
          $ref: "#/definitions/LoginMethod"
      payment_info:
        $ref: "#/definitions/PaymentInfo"
      color:
        type: string
        example: "#FFFFFF"
      updated_at:
        type: string
        format: date-time
      login_actions:
        type: array
        items:
          type: object
          $ref: "#/definitions/LoginAction"
    required:
      - institution_id
      - countries
      - institution_type
      - products_supported
      - institution_name
      - user_type
      - status
      - login_details

  # We will enable this once all our customers have stopped using legacy fields
  # LoginDetails:
  #   properties:
  #     info_message:
  #       type: string
  #       example: "Use credentials: User ID = usergood | Password = datagood"
  #     secret_required:
  #       type: boolean
  #       example: true

  LoginMethod:
    properties:
      id:
        type: string
        example: "SMS OTP"
      name:
        type: string
        example: "SMS OTP"
      is_default_method:
        type: boolean
        example: true
        x-nullable: true
      status:
        type: string
        enum: [SUPPORTED, ALPHA, BETA]
        example: SUPPORTED
      login_fields:
        type: array
        items:
          type: object
          $ref: "#/definitions/LoginField"

  # This model is near identitcal to the action model, however we do not want action_id here
  LoginAction:
    properties:
      type:
        type: string
        example: "ACTION"
      name:
        type: string
        example: "MOBILE_OTP"
      messages:
        type: array
        items:
          type: object
          $ref: "#/definitions/UserMessage"
      fields:
        type: array
        items:
          type: object
          $ref: "#/definitions/UserField"
      buttons:
        type: array
        items:
          type: object
          $ref: "#/definitions/UserButton"

  LoginField:
    properties:
      key:
        type: string
        example: "password"
      name:
        type: string
        example: "Password"
      type:
        type: string
        example: "password"
        description: "could be password, text, number"

  TokenRequest:
    properties:
      client_id:
        type: string
        minLength: 26 # One ULID = 26 chars
        maxLength: 26
      client_secret:
        type: string
        minLength: 64 # One ULID = 26 chars
        maxLength: 80 # Prefix w/ unix timestamp upto the year ~2275
      grant_type:
        type: string
        maxLength: 100
        description: support only client_credentials
    required:
      - client_id
      - client_secret
      - grant_type

  TokenResponse:
    properties:
      access_token:
        type: string
      token_type:
        type: string
      expires_in:
        type: number
        format: int64
        description: seconds
      issued_at:
        type: string
        format: date-time
    required:
      - access_token
      - token_type
      - expires_in
      - issued_at

  LinkTokenRequest:
    properties:
      grant_type:
        type: string
        description: support only client_credentials
        maxLength: 100
      response_type:
        type: string
        example: code
        maxLength: 100
      response_mode:
        type: string
        example: form_post
        maxLength: 100
      user_id:
        type: string
        description: required when creating new Link, ignored when updating existing Link
        example: 01BX5ZZKBKACTAV9WEVGEMMVRY
        minLength: 4
        maxLength: 100
      client_id:
        type: string
        example: 3fa85f64-5717-4562-b3fc-2c963f66afa6
        minLength: 4
        maxLength: 100
      redirect_uri:
        type: string
        example: https://example.com/callback
        minLength: 4
        maxLength: 500
      state:
        type: string
        example: user-state-passed
        maxLength: 100
      scope:
        type: string
        example: comma,separated,scopes
        maxLength: 500
      link_mode:
        type: string
        description: Space separated list of the tags of the institutions to view.
        example: real
        maxLength: 100
      ui_mode:
        type: string
        enum: &UI_MODE [iframe, redirect, auto_redirect, standalone]
        description: The UI mode link is intended to be used in - "iframe", "auto_redirect", "redirect" or "standalone"
        example: "redirect"
      language:
        type: string
        description: ISO639-1 language code. Language to display when user open the link, default to English (en) if not specified
        example: en
        enum: &LANGUAGE ["en", "vi", "zh", "ko"]
        maxLength: 3
      code_challenge:
        type: string
        example: code-challenge
        maxLength: 100
      code_challenge_method:
        type: string
        example: code-challenge-method
        maxLength: 100
      login_identity_id:
        type: string
        description: use this to update a specific login identity
        example: uhdasidasodaso
        maxLength: 100
      customization_id:
        type: string
        description: The customization id if the customer wishes to embed it into link token for spawning link with their choice of stuffs
        example: AULIDGOESHERE
        maxLength: 100
      institution_id:
        type: string
        description: Institution to preselect
        example: hsbc-hk
        maxLength: 100
      countries:
        type: array
        items:
          type: string
          maxLength: 3
        description: institution's country filter
        example: ["HKG", "SGP"]
      user_type:
        type: array
        items:
          type: string
          maxLength: 100
        description: institution's supported user_type filter
        example: ["PERSONAL"]
      products_supported:
        type: array
        items:
          type: string
          maxLength: 100
        description: institution's supported product filter
        example: ["ACCOUNTS", "TRANSACTIONS"]
      products_requested:
        type: array
        items:
          type: string
          maxLength: 100
        description: products that is requested
        example: ["ACCOUNTS", "TRANSACTIONS", "PAYMENTS"]
      payment_instruction_id:
        type: string
        description: The identifier returned after creating payment instruction
        example: payment_instruction_id
        maxLength: 100
      automatic_data_refresh:
        type: string
        description: Controls the behavior of the automatic data refresh checkbox
        enum: ["ON", "OFF", "FORCED_ON"]
        maxLength: 100
      institution_status:
        type: string
        description: institution's status filter
        example: "alpha beta supported"
        maxLength: 100
      user_configs:
        $ref: '#/definitions/LinkTokenUserConfigs'
    required:
      - grant_type
      - response_type
      - response_mode
      - redirect_uri
      - client_id

  LinkTokenUserConfigs:
    properties:
      ada_account_number:
        type: string
        description: Account Number to use for ADA setup

  LinkTokenResponse:
    properties:
      access_token:
        type: string
      token_type:
        type: string
      expires_in:
        type: number
        format: int64
        description: seconds
      issued_at:
        type: string
        format: date-time
      link_url:
        type: string
        example: https://link.dev.finverse.net/onboarding?token=dasdsa8erhiu7rey78r
    required:
      - access_token
      - token_type
      - expires_in
      - link_url
      - issued_at

  RefreshTokenResponse:
    properties:
      access_token:
        type: string
      token_type:
        type: string
      expires_in:
        type: number
        format: int64
        description: seconds
      issued_at:
        type: string
        format: date-time
      link_url:
        type: string
        example: https://link.dev.finverse.net/onboarding?token=dasdsa8erhiu7rey78r
      login_identity_id:
        type: string
    required:
      - access_token
      - token_type
      - expires_in
      - link_url
      - issued_at
      - login_identity_id

  LinkRequest:
    properties:
      institution_id:
        type: string
        example: ez-bank
        minLength: 2
        maxLength: 100
      store_credential:
        type: boolean
        example: true
      consent:
        type: boolean
        example: true
        description: this is a mandatory field
        x-nullable: true
      products_requested:
        type: array
        items:
          type: string
          maxLength: 100
        description: products that is requested
        example: ["ACCOUNTS", "TRANSACTIONS", "PAYMENTS"]
      payment_instruction_id:
        type: string
        description: The identifier returned after creating payment instruction
        example: payment_instruction_id
        maxLength: 100
    required:
      - institution_id
      - store_credential

  ConfirmPaymentResponse:
    properties:
      success:
        type: boolean
        example: true
    required:
      - success

  PaymentLinkTokenResponse:
    properties:
      access_token:
        type: string
        description: Short-lived access-token to interact with Finverse Link
      expires_in:
        type: integer
        format: int64
        description: Access token validity duration (in seconds)
      link_url:
        type: string
        description: URL to launch Finverse Link to authorize the mandate
      token_type:
        type: string
        enum: ["Bearer"]
    required:
      - access_token
      - expires_in
      - link_url
      - token_type

  ApiLinkRequest:
    properties:
      institution_id:
        type: string
        example: ez-bank
        minLength: 2
        maxLength: 100
      user_id:
        type: string
        description: "Identifier for end user"
        maxLength: 100
      consent:
        type: boolean
        example: true
        description: this is a mandatory field
        x-nullable: true
      products_requested:
        type: array
        items:
          type: string
          maxLength: 100
        description: products that are requested
        example: ["ACCOUNTS", "TRANSACTIONS", "PAYMENTS"]
      store_credentials:
        type: boolean
        example: true
      encrypted_credentials:
        $ref: "#/definitions/EncryptedPayload"
      payment_instruction_id:
        type: string
        maxLength: 100
    required:
      - institution_id
      - user_id
      - consent
      - products_requested
      - store_credentials
      - encrypted_credentials

  ApiRelinkRequest:
    properties:
      store_credential:
        type: boolean
      consent:
        type: boolean
      encrypted_credentials:
        $ref: "#/definitions/EncryptedPayload"
    required:
      - consent
      - encrypted_credentials

  RelinkRequest:
    properties:
      store_credential:
        type: boolean
        example: true
      consent:
        type: boolean
        example: true
        description: this is a mandatory field
        x-nullable: true
    required:
      - store_credential

  ActionRequest:
    properties:
      encrypted_credentials:
        $ref: "#/definitions/EncryptedPayload"
      action_id:
        type: string
        description: The action id
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
        maxLength: 100
    required:
      - encrypted_credentials
      - action_id

  GetLoginIdentityByIdResponse:
    properties:
      login_identity:
        $ref: "#/definitions/LoginIdentity"
      institution:
        $ref: "#/definitions/InstitutionShort"

  GetLoginIdentityHistoryResponse:
    properties:
      login_identity:
        $ref: "#/definitions/LoginIdentity"
      status_history:
        type: array
        items:
          $ref: "#/definitions/LoginIdentityStatusDetails"

  LoginIdentityStatusDetails:
    properties:
      event_date:
        type: string
        format: date-time
      event_name:
        type: string

  LoginIdentityLoginMethodsAvailable:
    type: object
    properties:
      havePassword:
        type: boolean
      haveSecret:
        type: boolean

  LoginIdentityBillingDetails:
    properties:
      billed_products:
        type: array
        items:
          type: string

  LoginIdentityShort:
    properties:
      login_identity_id:
        type: string
        format: ulid
      status:
        type: string
        example: LINKING
      last_session_id:
        type: string
        format: ulid

  LoginIdentity:
    properties:
      login_identity_id:
        type: string
        format: ulid
      customer_app_id:
        type: string
        format: ulid
      user_id:
        type: string
        example: form_post
      login_methods_available:
        $ref: "#/definitions/LoginIdentityLoginMethodsAvailable"
        example: {}
      permissions_grant_date:
        type: string
        format: date-time
      permissions_expiry_date:
        type: string
        format: date-time
      permissions:
        type: array
        items:
          type: string
      billing_details:
        $ref: "#/definitions/LoginIdentityBillingDetails"
        example: {}
      status:
        type: string
        example: LINKING
      status_details:
        $ref: "#/definitions/LoginIdentityStatusDetails"
        example: {}
      product_status:
        $ref: "#/definitions/AllProductStatus"
      authentication_status:
        $ref: "#/definitions/ProductStatus"
      error:
        $ref: "#/definitions/LoginIdentityError"
        example: {}
      last_success:
        type: string
        format: date-time
      first_success:
        type: string
        format: date-time
      webhook:
        type: string
        format: uri
        example: https://auth.example.com/callback
      session_status:
        type: string
        example: COMPLETED
      institution_id:
        type: string
        example: 123
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
      linking_attempt_id:
        type: string
        example: 123
        description: a login attempt id which is unique per login_identity
      authentication_id:
        type: string
        example: 123
        description: a successful login attempt id which is unique per login_identity
      last_session_id:
        type: string
        format: ulid
      refresh:
        $ref: "#/definitions/RefreshData"
    required:
      - user_id
      - customer_app_id
      - institution_id

  RefreshData:
    type: object
    properties:
      credentials_stored:
        type: boolean
      refresh_allowed:
        type: boolean
    required:
      - credentials_stored
      - refresh_allowed

  LoginIdentityError:
    type: object
    properties:
      code:
        type: integer
      type:
        type: string
        example: "INVALID_CREDENTIALS"
      message:
        type: string
        example: "Credentials invalid"
      details:
        type: string
        example: "Credentials are invalid. Please try again."

  DeleteLoginIdentityResponse:
    type: object
    properties:
      success:
        type: boolean
        example: "true"

  LinkResponse:
    properties:
      auth_url:
        type: string
        example: https://auth.example.com/auth?client_id=clientIDstate=userState&redirect_url=callback

  AccessTokenResponse:
    properties:
      access_token:
        type: string
      login_identity_id:
        type: string
      token_type:
        type: string
      expires_in:
        type: number
        format: int64
        description: seconds
      refresh_token:
        type: string
      issued_at:
        type: string
        format: date-time
    required:
      - access_token
      - login_identity_id
      - token_type
      - expires_in
      - refresh_token
      - issued_at

  GetStatementsResponse:
    properties:
      statements:
        type: array
        items:
          $ref: "#/definitions/Statement"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"

  GetStatementLinkResponse:
    properties:
      statement_links:
        type: array
        items:
          $ref: "#/definitions/StatementLink"

  Statement:
    properties:
      id:
        type: string
        example: "daiosdosi7823e43"
      date:
        type: string
        description: "YYYY-MM-DD"
        example: "2021-02-01"
      name:
        type: string
        example: "BusinessVantage"
      created_at:
        type: string
        format: date-time
        example: "2021-02-01T10:01:02.333Z"

  StatementLink:
    properties:
      url:
        type: string
        description: signedURL to download statement
        example: "https://www.finverse.net/statement.pdf"
      expiry:
        type: string
        format: date-time
        description: expiry of the signedURL
      statement_id:
        type: string
        example: "sadasd"

  AllProductStatus:
    properties:
      accounts:
        $ref: "#/definitions/ProductStatus"
      online_transactions:
        $ref: "#/definitions/ProductStatus"
      statements:
        $ref: "#/definitions/ProductStatus"
      historical_transactions:
        $ref: "#/definitions/ProductStatus"
      account_numbers:
        $ref: "#/definitions/ProductStatus"
      identity:
        $ref: "#/definitions/ProductStatus"
      balance_history:
        $ref: "#/definitions/ProductStatus"
      payments:
        $ref: "#/definitions/ProductStatus"
      income_estimation:
        $ref: "#/definitions/ProductStatus"
      card_details:
        $ref: "#/definitions/ProductStatus"

  ProductStatus:
    properties:
      status:
        type: string
        description: The current health of this product
        example: IN_PROGRESS, SUCCESS, PARTIAL_ERROR, WARNING, ERROR
      status_details:
        type: string
        description: The detailed event name
        example: AUTHENTICATION_INITIALIZED
      last_update:
        type: string
        format: date-time
        example: "2021-02-01T10:01:02.333Z"
        x-nullable: true
      last_successful_update:
        type: string
        format: date-time
        example: "2021-02-01T10:01:02.333Z"
        x-nullable: true

  CardDetails:
    properties:
      card_accounts:
        type: array
        items:
          $ref: "#/definitions/CardAccount"
      card_total:
        $ref: "#/definitions/CardTotal"

  CardAccount:
    properties:
      account_id:
        type: string
        description: Account this card is associated with
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      account_name:
        type: string
        example: HKD Visa
      account_number_masked:
        type: string
        description: "Masked Account number of the card account"
      account_type:
        $ref: "#/definitions/AccountType"
        description: "Account Type"
      statement_payment_due_date:
        type: string
        description: "The statement payment due date"
        example: "2021-02-01"
      next_payment_due_date:
        type: string
        description: "The next payment due date"
        example: "2021-02-01"
      statement_date:
        type: string
        example: "2021-10-27"
        description: "The statement date"
      last_payment_date:
        type: string
        example: "2021-10-27"
        description: "The date of the last payment"
      last_payment_amount:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      current_balance:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      payment_due_amount:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      statement_due_amount:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      total_credit_limit:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      available_credit_limit:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      minimum_payment_due:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      rewards_balances:
        type: array
        items:
          $ref: "#/definitions/GenericAmount"
      updated_at:
        type: string
        format: date-time
        example: "2021-02-01T10:01:02.333Z"

  CardTotal:
    properties:
      current_balance:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      payment_due_amount:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      statement_due_amount:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      total_credit_limit:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      available_credit_limit:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      minimum_payment_due:
        type: object
        $ref: "#/definitions/CurrencyAmount"
      rewards_balances:
        type: array
        items:
          $ref: "#/definitions/GenericAmount"
      updated_at:
        type: string
        format: date-time
        example: "2021-02-01T10:01:02.333Z"

  PaymentDetails:
    properties:
      format:
        type: string
        example: SWIFT
      bic:
        type: string
        example: BKCHHKHHXXX
      bank_fullname:
        type: string
        example: Finverse test bank
      bank_shortname:
        type: string
        example: testbank
      bank_address:
        type: string
        example: 99 Stree, Building, City
      bank_country:
        type: string
        example: Country
      other_info:
        $ref: "#/definitions/OtherInfo"

  OtherInfo:
    properties:
      bank_code:
        type: string

  RedirectUriResponse:
    properties:
      redirect_uri:
        type: string

  IncomeEstimate:
    properties:
      amount:
        type: number
        description: Income amount
        example: 100
      currency:
        type: string
        description: Currency
        example: HKD
    required:
      - amount
      - currency

  MonthlyIncomeEstimate:
    properties:
      estimated_income:
        $ref: "#/definitions/IncomeEstimate"
      month:
        type: number
        format: int32
        description: The numeric month
        example: 1
      year:
        type: number
        format: int32
        description: The year
        example: 2020
    required:
      - estimated_income
      - month
      - year

  IncomeStream:
    properties:
      account_id:
        type: string
        description: Account this income estimate is associated with
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      estimated_monthly_income:
        $ref: "#/definitions/IncomeEstimate"
      transaction_count:
        type: number
        format: int64
        description: Number of transactions counted towards income
        example: 3
      monthly_history:
        type: array
        items:
          $ref: "#/definitions/MonthlyIncomeEstimate"
    required:
      - account_id
      - transaction_count
      - monthly_history

  IncomeTotal:
    properties:
      estimated_monthly_income:
        $ref: "#/definitions/IncomeEstimate"
      transaction_count:
        type: number
        format: int64
        description: Number of transactions counted towards income
        example: 3
      monthly_history:
        type: array
        items:
          $ref: "#/definitions/MonthlyIncomeEstimate"
    required:
      - transaction_count
      - monthly_history

  SingleSourceIncome:
    properties:
      income_streams:
        type: array
        items:
          $ref: "#/definitions/IncomeStream"
      income_total:
        $ref: "#/definitions/IncomeTotal"
      source:
        type: string
        description: Where the income estimate was sourced from
        example: DEPOSITS_ANALYSIS
      source_id:
        type: string
        description: Unknown
    required:
      - income_total
      - income_streams
      - source
      - source_id

  IncomeResponse:
    properties:
      income:
        type: array
        items:
          $ref: "#/definitions/SingleSourceIncome"
      login_identity:
        $ref: "#/definitions/LoginIdentityShort"
      institution:
        $ref: "#/definitions/InstitutionShort"
    required:
      - income
      - login_identity
      - institution

  PaymentAccount:
    properties:
      raw:
        type: string
        description: The raw value for the account the user selected when making payment request
      institution_id:
        type: string
        description: Finverse Institution ID. Only returned if institution_id was included in the request.

  CompositeStatementLink:
    properties:
      url:
        type: string
        description: signedURL to download statement
        example: "https://www.finverse.net/statement.pdf"
      expiry:
        type: string
        format: date-time
        description: expiry of the signedURL
    required:
      - url
      - expiry

  GetJWKSResponse:
    properties:
      keys:
        type: array
        items:
          $ref: "#/definitions/JWKSKey"

  JWKSKey:
    properties:
      kty:
        type: string
        description: The "kty" (key type) parameter identifies the cryptographic algorithm family used with the key, such as "RSA" or "EC".
      kid:
        type: string
        description: The "kid" (key ID) parameter is used to match a specific key
      use:
        type: string
        description: The "use" (public key use) parameter identifies the intended use of the public key
      e:
        type: string
        description: RSA key value "e"
      "n":
        type: string
        description: RSA key value "n"
      x5c:
        description: The "x5c" (X.509 certificate chain) parameter contains a chain of one or more PKIX certificates
        type: array
        items:
          type: string

  EncryptedPayload:
    properties:
      ciphertext:
        type: string
        description: The credential payload encrypted with AES (base64)
      initializationVector:
        type: string
        description: The 16 byte IV used w/ AES (base64)
      messageAuthenticationCode:
        type: string
        description: The MAC to verify AES decryption validity
      envelopeEncryptionKey:
        type: string
        description: The AES key encrypted with an RSA pubkey (base64)
      keyId:
        type: string
        description: The identifier of the public key used to encrypt the AES key
    required:
      - ciphertext
      - initializationVector
      - messageAuthenticationCode
      - envelopeEncryptionKey
      - keyId

  LinkStatusResponse:
    properties:
      success:
        $ref: "#/definitions/AccessTokenResponse"
      pending:
        $ref: "#/definitions/LinkStatusPendingModel"
      action:
        $ref: "#/definitions/LinkStatusActionModel"

  NonSensitiveLinkStatusSuccessModel:
    properties:
      code:
        type: string
      state:
        type: string
      login_identity_id:
        type: string
  
  NonSensitiveLinkStatusResponse:
    properties:
      action:
        $ref: "#/definitions/LinkStatusActionModel"
      redirect_uri:
        type: string
      success:
        $ref: "#/definitions/NonSensitiveLinkStatusSuccessModel"
      error:
        $ref: "#/definitions/FvErrorModelV2"

  LinkStatusPendingModel:
    properties:
      code:
        type: string
      message:
        type: string
      details:
        type: string

  LinkStatusActionModel:
    properties:
      action_id:
        type: string
        description: Unique identifier
      type:
        type: string
        description: The type of user screen the UI is to render
        example: ACTION
      name:
        type: string
        description: The name of the user screen the UI is to render
        example: DEVICE_SELECTION
      messages:
        type: array
        items:
          $ref: "#/definitions/UserMessage"
      fields:
        type: array
        items:
          $ref: "#/definitions/UserField"
      buttons:
        type: array
        items:
          $ref: "#/definitions/UserButton"
    required:
      - action_id
      - type
      - name
      - messages
      - fields

  UserMessage:
    properties:
      name:
        type: string
        description: The name of the message
      type:
        type: string
        description: The type of the message. This will help how the UI renders this text.
      value:
        type: string
        description: The actual text value.
    required:
      - name
      - type
      - value

  UserField:
    properties:
      name:
        type: string
        description: The name of the field. This will be used as the key when submitting response.
      label:
        type: string
        description: The label for this field.
      placeholder:
        type: string
        description: The placeholder for this field.
      type:
        type: string
        description: The type of field. Currently it can only be SELECT, INPUT or PASSWORD
        example: SELECT
      options:
        type: array
        description: This is only applicable when the field type is SELECT
        items:
          $ref: "#/definitions/UserFieldOption"
    required:
      - name
      - type

  UserButton:
    properties:
      name:
        type: string
        description: The name of the button.
      value:
        type: string
        description: The text that will be displayed for this button
        example: Submit One time password
      type:
        type: string
        description: The type of button. Currently it can only be SUBMIT
        example: SUBMIT
    required:
      - name
      - value
      - type

  UserFieldOption:
    properties:
      label:
        type: string
        description: The value displayed in the select element.
        example: joe-iphone-13
      value:
        type: string
        description: The value that will be submitted if this option was selected.
        example: Joe's iPhone 13 Pro Max
    required:
      - label
      - value

  # This is target error we should be using for all new endpoints
  ErrBodyModelV2:
    properties:
      error:
        type: object
        $ref: "#/definitions/FvErrorModelV2"

  # FvEmbeddedErrorModelV2 should only be used when we have error embedded as part of other main resources like mandate / payment etc
  FvEmbeddedErrorModel:
    properties:
      type:
        type: string
        enum: [LINK_ERROR, API_ERROR]
        description: The error type
        example: LINKING_ERROR
      error_code:
        type: string
        example: CREDENTIALS_INVALID
      message:
        type: string
      details:
        type: string
    required:
      - type
      - error_code
      - message
      - details

  # DONOTUSE
  # This is the inner part of ErrBodyModelV2 and should not be used directly
  FvErrorModelV2:
    properties:
      type:
        type: string
        enum: [LINK_ERROR, API_ERROR]
        description: The error type
        example: LINKING_ERROR
      error_code:
        type: string
        example: CREDENTIALS_INVALID
      message:
        type: string
      details:
        type: string
      request_id:
        type: string
        description: The request_id provided in the request header
    required:
      - type
      - error_code
      - message
      - details
      - request_id

  # DONOTUSE
  # This is a backward compatible version of V2, since
  # The inner object has "code" of type "string"
  # (legacy)
  ErrBodyModel:
    properties:
      error:
        type: object
        $ref: "#/definitions/FvErrorModel"

  # DONOTUSE
  # This is an old model, only kept for backward compatibility
  # (legacy)
  SwaggerErrBodyModel:
    properties:
      code:
        type: integer
      message:
        type: string
      error:
        type: object
        $ref: "#/definitions/FvErrorModel"

  # DONOTUSE
  # This is the inner part of ErrBodyModel, and should not be used directly
  # This is only present for backward compatibility on the "code" field
  # (legacy)
  FvErrorModel:
    properties:
      type:
        type: string
        enum: [LINK_ERROR, API_ERROR]
        description: The error type
        example: LINKING_ERROR
      error_code:
        type: string
        example: CREDENTIALS_INVALID
      code:
        type: string
        example: CREDENTIALS_INVALID
      message:
        type: string
      details:
        type: string
      request_id:
        type: string
        description: The request_id provided in the request header
    required:
      - type
      - code
      - error_code
      - message
      - details
      - request_id

  # DONOTUSE
  # This is only kept for backward compatibility
  # (legacy)
  ErrorResponse:
    type: object
    properties:
      err:
        type: string
      http_status_code:
        type: number
        format: int
      status_text:
        type: string
      app_code:
        type: number
        format: int64
      error_category:
        type: string
      error_text:
        type: string
      request_id:
        type: string

  # DONOTUSE
  # Only kept for backward compatibility
  # (legacy)
  BadRequestModel:
    properties:
      error:
        type: object
        properties:
          code:
            type: number
            example: 40004
          name:
            type: string
            example: CREDENTIAL_NOT_STORED
          message:
            type: string
            example: Credential for this LoginIdentity is not stored. Please relink.
          link:
            type: string
            description: A link to visit for further action
            example: link.finverse.com

  # DONOTUSE
  # Only kept for backward compatibility
  # (legacy)
  BadRequestModelV2:
    properties:
      error:
        type: object
        properties:
          type:
            type: string
            enum: [LINK_ERROR, API_ERROR]
            description: The error type
            example: LINKING_ERROR
          error_code:
            type: string
            example: CREDENTIALS_INVALID
          code:
            type: number
            example: 40004
          message:
            type: string
          details:
            type: string
          request_id:
            type: string
            description: The request_id provided in the request header
        required:
          - type
          - code
          - error_code
          - message
          - request_id

  CreateMetadata:
    type: object
    additionalProperties:
      type: string
      maxLength: 1000

  PaymentInfo:
    properties:
      currencies_supported:
        type: array
        example: [HKD, CNY]
        items:
          type: string
      payments_supported:
        type: array
        example: [MANDATE, DEBIT_AUTHORIZATION]
        items:
          type: string
          enum: [MANDATE, DEBIT_AUTHORIZATION]
      other_info:
        $ref: "#/definitions/OtherInfo"
    required:
      - payments_supported

  AccountType:
    properties:
      type:
        type: string
        example: "DEPOSIT"
        enum: [DEPOSIT, CARD, INVESTMENT, LOAN, UNKNOWN]
      subtype:
        type: string
        example: "SAVINGS"
        enum:
          [
            CURRENT,
            SAVINGS,
            TIME_DEPOSIT,
            OTHER,
            CREDIT_CARD,
            DEBIT_CARD,
            SECURITIES,
            FUNDS,
            STOCKS,
            BONDS,
            MORTGAGE,
            PERSONAL_LOAN,
            REVOLVING_LOAN,
            UNKNOWN,
          ]

  CreatePaymentRequest:
    properties:
      amount:
        type: integer
        example: 100
        description: Amount to be paid, in currency's smallest unit or minor unit, as defined in ISO 4217. For example, HKD 100.01 is represented as amount = 10001 (minor unit = cents). For currencies without minor units (e.g. VND, JPY), the amount is represented as is, without modification. For example, VND 15101 is represented as amount = 15101.
      currency:
        type: string
        example: HKD
        description: The currency code as defined in ISO 4217.
        maxLength: 3
      payment_method_id:
        type: string
        description: ID of the payment method this pament is referring to.
      payment_details:
        description: Additional details required for each payment type.
        $ref: "#/definitions/PaymentDetails2"
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the payment in key:value format (e.g. payment_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
    required:
      - payment_details
      - amount
      - currency

  PaymentDetails2:
    properties:
      description:
        type: string
        description: The transaction description provided to banks, which banks will show to their customers.
        maxLength: 100
      mandate_id:
        type: string
        description: ID of the mandate this pament is referring to.
      transaction_reference_id:
        type: string
        description: "Deprecated: Customer's ID for this transaction"
      external_transaction_reference:
        type: string
        description: Customer reference for this transaction
        maxLength: 35
      references:
        $ref: "#/definitions/PaymentDetailsReferences"
      processor_entity_name: 
        type: string
      collection_entity_name: 
        type: string
      processor_details:
        x-nullable: true
        $ref: "#/definitions/PaymentProcessorDetails"
      recurring_payment_mode:
        type: string
        description: The recurring payment mode

  PaymentDetailsReferences:
    properties:
      finverse_transaction_reference:
        type: string
      dda_reference:
        type: string
      bank_transaction_reference:
        type: string

  PaymentProcessorDetails:
    properties:
      auth_code:
        type: string
      processor_id: 
        type: string
      processor_reference:
        type: string
      result:
        $ref: "#/definitions/PaymentProcessorResult"

  PaymentProcessorResult:
   properties:
    decline_code:
      type: string
      description: Payment processor's decline code (e.g. "2")
    decline_reason:
      type: string
      description: Payment processor's decline explanation (e.g. "Blocked card")
    result_code:
      type: string
      description: Payment processor's result code (e.g. "Authorized", "Refused").
  
  PaymentResponse:
    properties:
      payment_id:
        type: string
        description: Finverse Payment ID
      amount:
        type: integer
        example: 100
        description: Amount to be paid, in currency's smallest unit or minor unit, as defined in ISO 4217. For example, HKD 100.01 is represented as amount = 10001 (minor unit = cents). For currencies without minor units (e.g. VND, JPY), the amount is represented as is, without modification. For example, VND 15101 is represented as amount = 15101.
      surcharge_amount:
        type: integer
        example: 100
        description: Surcharge amount in minor
      amount_total_with_surcharge:
        type: integer
        example: 100
        description: Amount with all fees and surcharges applied in minor
      currency:
        type: string
        example: HKD
        description: The currency code as defined in ISO 4217.
      type:
        type: string
        description: Indicates whether this is a mandate-based payment or one-off direct payment to an account. Possible values - MANDATE, SINGLE
        enum: &PAYMENT_TYPE ["MANDATE", "SINGLE", "CARD", "MANUAL"]
      updated_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      status:
        type: string
        description: Possible values - CREATED, AUTHORIZED, SUBMITTED, EXECUTED, FAILED, REJECTED, CANCELLED.
        enum:
          &PAYMENT_STATUS [
            "AUTHORIZATION_REQUIRED",
            "AUTHORIZING",
            "PROCESSING",
            "SUBMITTED",
            "EXECUTED",
            "FAILED",
            "REVOKED",
            "CANCELLED",
            "CREATED"
          ]
      payment_method_id:
        type: string
        description: ID of the payment method this pament is referring to.
      payment_details:
        description: Additional details required for each payment type.
        $ref: "#/definitions/PaymentDetails2"
      recipient:
        $ref: "#/definitions/MandateRecipient"
      recipient_account:
        $ref: "#/definitions/MandateRecipientAccount"
      sender:
        $ref: "#/definitions/GetMandateSender"
      sender_account:
        $ref: "#/definitions/MandateSenderAccount"
      fees:
        type: array
        items:
          $ref: "#/definitions/Fee"
      created_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      metadata:
        type: object
        additionalProperties:
          type: string
        description: "Additional attributes of the payment in key:value format (e.g. payment_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"
      payment_method:
        $ref: "#/definitions/PaymentSnapshotPaymentMethod"
    required:
      - amount
      - surcharge_amount
      - amount_total_with_surcharge

  ListPaymentsResponse:
    properties:
      payments:
        type: array
        items:
          $ref: "#/definitions/PaymentResponse"
      total_payments:
        type: integer
    required:
      - total_payments

  CreateScheduledPayoutRequest:
    properties:
      amount:
        type: integer
        example: 100
        description: Amount to be paid, in currency's smallest unit or minor unit, as defined in ISO 4217. For example, HKD 100.01 is represented as amount = 10001 (minor unit = cents). For currencies without minor units (e.g. VND, JPY), the amount is represented as is, without modification. For example, VND 15101 is represented as amount = 15101.
      currency:
        type: string
        example: HKD
        description: The currency code as defined in ISO 4217.
        maxLength: 3
      payment_details:
        description: Additional details required for each payment type.
        $ref: "#/definitions/PayoutDetails"
      recipient_account:
        $ref: "#/definitions/MandateRecipientRequest"
        description: Information about the accountholder receiving the payment. See below.
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the payout instruction in key:value format (e.g. payout_instruction_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
    required:
      - payment_details
      - recipient_account
      - amount
      - currency

  PayoutSnapshotResponse:
    properties:
      payout_id:
        type: string
      status:
        type: string
        enum: &PAYOUT_STATUS ["EXECUTED", "CREATED", "PROCESSING", "PROCESSING_FUNDS", "CANCELLED", "FAILED", "FUNDED", "SUBMITTED"]
      type:
        type: string
        enum: &PAYOUT_TYPE ["MANUAL", "SCHEDULED", "SETTLEMENT"]
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
      transaction_date:
        type: string
      transaction_time:
        type: string
        format: date-time
        x-nullable: true
        example: "2025-08-22T12:00:00Z"
      payment_details:
        $ref: "#/definitions/PayoutSnapshotDetails"
      metadata:
        type: object
        additionalProperties:
          type: string
      amount:
        type: integer
      currency:
        type: string
      sender:
        $ref: "#/definitions/MandateRecipient"
      sender_account:
        $ref: "#/definitions/MandateRecipientAccount"
      recipient:
        $ref: "#/definitions/GetMandateSender"
      recipient_account:
        $ref: "#/definitions/MandateSenderAccount"
      fees:
        type: array
        items:
          $ref: "#/definitions/Fee"
      live:
        type: boolean
        description: Whether this payout is live or not
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"
    required:
      - live

  ListPayoutsResponse:
    properties:
      payouts:
        type: array
        items:
          $ref: '#/definitions/PayoutSnapshotResponse'
      total_payouts:
        type: integer
    required:
      - payouts
      - total_payouts

  PayoutSnapshotDetails:
    properties:
      description:
        type: string
      transaction_reference_id:
        type: string
      mandate_id:
        type: string
      scheduled_date:
        type: string
        format: date-time
        x-nullable: true
      estimated_arrival_time:
        type: string
        format: date-time
        x-nullable: true
        example: "2025-08-22T12:00:00Z"
      processor_details:
        $ref: "#/definitions/PayoutProcessorDetails"
      references:
        $ref: "#/definitions/PayoutReferences"

  PayoutProcessorDetails:
    properties:
      processor_id:
        type: string
      processor_reference:
        type: string
  
  PayoutReferences:
    properties:
      recipient_reference:
        type: string

  PayoutDetails:
    properties:
      mandate_id:
        type: string
        description: The mandate used to execute payments for this payout instruction. Currency for the mandate must be supported by the recipient account
      description:
        type: string
        description: A description for the payment (that will appear as the transaction description on bank statements)
      scheduled_date:
        type: string
        format: date
        description: YYYY-MM-DD, date (in UTC) to execute the payment, must be 1 day later than current date
    required:
      - mandate_id
      - scheduled_date

  CreatePaymentInstructionResponse:
    properties:
      payment_instruction_id:
        type: string

  GetPaymentInstructionsResponse:
    properties:
      payment_instruction:
        $ref: "#/definitions/PaymentInstruction"

  UpdateTestPaymentStatusRequest:
    properties:
      status:
        type: string
        description: The payment status
        enum: ["EXECUTED"]

  CustomerPaymentInstruction:
    properties:
      user_id:
        type: string
        description: A id of the user of this payment, need to equal to userId when creating link
        example: 01BX5ZZKBKACTAV9WEVGEMMVRY
      type:
        type: string
        description: Type of payment is being created, please check Documentation on which payment type is supported in each institution
        enum: ["DEBIT_AUTHORIZATION"]
      recipient_name:
        type: string
        description: The recipient name
        example: John Wick
      recipient_account_id:
        type: string
        description: The recipient account Id
        example: Something
      sender_name:
        type: string
        description: The sender name
        example: Jane Doe
      sender_account_id:
        type: string
        description: The sender account Id
        example: Something
      start_date:
        type: string
        description: When the payment should start
        example: 2022-01-23
        format: date
        x-nullable: true
      end_date:
        type: string
        description: When the payment should stop
        example: 2022-11-30
        format: date
        x-nullable: true
      currency:
        type: string
        description: The currency for the payment
        example: HKD
      amount:
        type: number
        description: The payment amount
        example: 123.45
      frequency:
        type: string
        description: How often the payment should be executed
        example: DAILY, WEEKLY OR MONTHLY
      remarks:
        type: string
        description: Related remarks about this instruction
        example: This is regular payment to pay for loan
    required:
      - user_id
      - type

  PaymentInstruction:
    properties:
      payment_instruction_id:
        type: string
        description: An id of the this payment
        example: 01BX5ZZKBKACTAV9WEVGEMMVRY
      user_id:
        type: string
        description: An id of the user of this payment, need to equal to userId when creating link
        example: 01BX5ZZKBKACTAV9WEVGEMMVRY
      login_identity_id:
        type: string
        description: An id that links this payment to a specific Login Identity
        example: 01BX5ZZKBKACTAV9WEVGEMMVRY
      type:
        type: string
        description: Type of payment that was created, please check Documentation on which payment type is supported in each institution
        enum: ["DEBIT_AUTHORIZATION"]
      recipient_name:
        type: string
        description: The recipient name
        example: John Wick
      recipient_account_id:
        type: string
        description: The recipient account Id
        example: Something
      sender_name:
        type: string
        description: The sender name
        example: Jane Doe
      sender_account:
        $ref: "#/definitions/PaymentAccount"
      sender_account_id:
        type: string
        description: The sender account Id
        example: The sender account ID
      start_date:
        type: string
        description: When the payment should start
        example: 2022-01-23
        format: date
        x-nullable: true
      end_date:
        type: string
        description: When the payment should stop
        example: 2022-11-30
        format: date
        x-nullable: true
      currency:
        type: string
        description: The currency for the payment
        example: HKD
      amount:
        type: number
        description: The payment amount
        example: 123.45
      frequency:
        type: string
        description: How often the payment should be executed
        example: DAILY, WEEKLY OR MONTHLY
      remarks:
        type: string
        description: Related remarks about this instruction
        example: This is regular payment to pay for loan
      status:
        type: string
        description: Status of the payment
        example: UNKNOWN, STARTED, SUBMITTED, FAILED, NOT_SUPPORTED OR TEMPORARILY_UNAVAILABLE_FOR_INSTITUTION
      reference_id:
        type: string
        description: Reference identification returned by institution
      last_update:
        type: string
        format: date-time
      info:
        type: object
        description: Extra information collected for this payment instruction

  CreateMandateRequest:
    properties:
      recipient_account:
        $ref: "#/definitions/MandateRecipientRequest"
        description: Information about the accountholder receiving the payment. See below.
      sender:
        $ref: "#/definitions/CreateMandateSender"
        description: Information about the accountholder sending the payment. See below.
      mandate_details:
        $ref: "#/definitions/MandateDetailsRequest"
        description: Additional details on the mandate. See below.
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the mandate in key:value format (e.g. mandate_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
    required:
      - recipient_account
      - sender
      - mandate_details

  CreateMandateRequestWithDdaReference:
    properties:
      recipient_account:
        $ref: "#/definitions/MandateRecipientRequest"
        description: Information about the accountholder receiving the payment. See below.
      sender_account:
        $ref: "#/definitions/MandateSenderAccountRequest"
        description: Information about the accountholder sending the payment. See below.
      mandate_details:
        $ref: "#/definitions/MandateDetailsRequestWithDdaReference"
        description: Additional details on the mandate. See below.
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the mandate in key:value format (e.g. mandate_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
      status:
        type: string
        enum: [SUCCEEDED]
        description: The mandate status
        example: SUCCEEDED 
    required:
      - recipient_account
      - sender_account
      - mandate_details
      - status

  CreateMandateWithSenderAccountRequest:
    properties:
      recipient_account:
        $ref: "#/definitions/MandateRecipientRequest"
        description: Information about the accountholder receiving the payment. See below.
      sender_account:
        $ref: "#/definitions/MandateSenderAccountRequest"
        description: Information about the accountholder sending the payment. See below.
      mandate_details:
        $ref: "#/definitions/MandateDetailsRequest"
        description: Additional details on the mandate. See below.
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the mandate in key:value format (e.g. mandate_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
    required:
      - recipient_account
      - sender_account
      - mandate_details

  CreateMandateResponse:
    properties:
      created_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      updated_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      mandate_id:
        type: string
        description: Finverse Mandate ID (ULID)
      payment_method_id:
        type: string
        description: Finverse Payment Method ID (ULID)
      status:
        type: string
        description: Mandate status
        enum:
          &MANDATE_STATUS [
            "AUTHORIZATION_REQUIRED",
            "AUTHORIZING",
            "PROCESSING",
            "SUBMITTED",
            "SUCCEEDED",
            "FAILED",
            "REVOKED",
            "READY_TO_SUBMIT",
            "CLOSED",
            "CANCELLED"
          ]
      recipient:
        $ref: "#/definitions/MandateRecipient"
      recipient_account:
        $ref: "#/definitions/MandateRecipientAccount"
      sender:
        $ref: "#/definitions/GetMandateSender"
      sender_account:
        $ref: "#/definitions/MandateSenderAccount"
      mandate_details:
        $ref: "#/definitions/MandateDetailsResponse"
      fees:
        type: array
        items:
          $ref: "#/definitions/Fee"
      metadata:
        type: object
        additionalProperties:
          type: string
        description: "Additional attributes of the mandate in key:value format (e.g. mandate_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"
    required:
      - updated_at
      - mandate_id
      - status
      - recipient
      - sender
      - mandate_details

  CreatePaymentLinkRequest:
    properties:
      amount:
        type: integer
        example: 100
        description: The amount of the payment. Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
        minimum: 1
      currency:
        type: string
        example: HKD
        minLength: 3
        maxLength: 3
      link_customizations:
        $ref: "#/definitions/PaymentLinkCustomizations"
      mode:
        type: string
        enum: [PAYMENT, SETUP]
        description: The payment link mode
        example: PAYMENT
      payment_details:
        type: object
        $ref: "#/definitions/PaymentLinkDetails"
      sender:
        type: object
        $ref: "#/definitions/PaymentLinkSender"
      unique_reference_id:
        type: string
        description: Unique reference id to identifying the payment to be collected.
        minLength: 1
      payment_setup_options:
        type: object
        description: Optional field indicating if mandatory AUTOPAY should be set
        $ref: "#/definitions/PaymentSetupOptionsRequest"
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the payment link in key:value format (e.g. payment_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
      payment_metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Key-Value metadata to store on payments created on this Payment Link. It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
      integration_metadata:
        $ref: "#/definitions/IntegrationMetadataRequest"
    required:
      - currency
      - mode
      - sender
      - unique_reference_id

  PaymentLinkDetails:
    properties:
      description:
        type: string
        maxLength: 100
      external_transaction_reference:
        type: string
        description: For external invoice/transaction reference
        maxLength: 35
    required:
      - description
      - external_transaction_reference

  UpdatePaymentRequest:
    properties:
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the payment in key:value format (e.g. payment_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
    additionalProperties: true

  PaymentLinkSender:
    properties:
      email:
        type: string
        format: email
      external_user_id:
        type: string
        description: Customer App's user ID, representing the end-user making the payment.
        minLength: 1
      name:
        type: string
        description: "Accountholder name of the sender's account"
        example: "Chan Li Pak"
        minLength: 1
    required:
      - external_user_id
      - name

  PaymentSetupOptions:
    properties:
      future_payments:
        type: string
        description: "The type of future_payments that customer want to use. Possible values: AUTOPAY or CLICK_TO_PAY"
        enum: [AUTOPAY, CLICK_TO_PAY]
      mandate_details:
        $ref: "#/definitions/MandateDetailsForPaymentLink"
      payment_method_types:
        type: array
        items:
          type: string
          enum: *PAYMENT_TYPE
        x-omitempty: true # Reference: https://github.com/go-swagger/go-swagger/issues/1206
      recipient_account_filters:
        $ref: '#/definitions/RecipientAccountFilters'
      autopay_enrollment_configuration:
        $ref: "#/definitions/AutopayEnrollmentConfiguration"
      recurring_payment_mode:
        type: string
        description: The recurring payment mode

  PaymentSetupOptionsRequest:
    properties:
      future_payments:
        type: string
        description: "The type of future_payments that customer want to use. Possible values: AUTOPAY or CLICK_TO_PAY"
        enum: [AUTOPAY, CLICK_TO_PAY]
      mandate_details:
        $ref: "#/definitions/MandateDetailsForPaymentLinkRequest"
      payment_method_types:
        type: array
        items:
          type: string
          enum: *PAYMENT_TYPE
        x-omitempty: true # Reference: https://github.com/go-swagger/go-swagger/issues/1206
      recipient_account_filters:
        $ref: '#/definitions/RecipientAccountFilters'
      autopay_enrollment_configuration:
        $ref: "#/definitions/AutopayEnrollmentConfiguration"
      recurring_payment_mode:
        type: string
        description: The recurring payment mode

  AutopayEnrollmentConfiguration:
    properties:
      display_enrollment_screen:
        description: Indicate whether the autopay enrollment screen should be prompted to the end user
        type: boolean
      enrollment_prefill_value:
        description: Indicate what value should be prefilled on the autopay enrollment screen
        type: string
        enum: ["YES", "NO"]
    required:
      - display_enrollment_screen
      - enrollment_prefill_value
  
  RecipientAccountFilters:
    properties:
      business_unit:
        type: string
        minLength: 1
    required:
      - business_unit # For now there is only one so we make it required. In future, we will have application logic to make sure at least one of the guys is set

  ListPaymentMethodsResponse:
    properties:
      payment_methods:
        type: array
        items:
          $ref: '#/definitions/PaymentMethodResponse'
      sender:
        $ref: '#/definitions/PaymentUserWithoutEmail'


  # this will be used by POST and GET Payment link api, since they have the same response
  PaymentLinkResponse:
    properties:
      payment_link_id:
        type: string
        description: Finverse Payment Link ID
      amount:
        type: integer
        example: 100
        description: The amount of the payment. Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
      currency:
        type: string
        example: HKD
      link_customizations:
        $ref: "#/definitions/PaymentLinkCustomizations"
      mode:
        type: string
        enum: [PAYMENT]
        description: The payment link mode
        example: PAYMENT
      payment_details:
        type: object
        $ref: "#/definitions/PaymentLinkDetails"
      unique_reference_id:
        type: string
        description: Unique reference id to identifying the payment to be collected.
        minLength: 1
      payment_setup_options:
        type: object
        description: Optional field indicating if mandatory AUTOPAY should be set
        $ref: "#/definitions/PaymentSetupOptions"
      metadata:
        type: object
        additionalProperties:
          type: string
        description: "Additional attributes of the payment link in key:value format (e.g. payment_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
      payment_metadata:
        type: object
        additionalProperties:
          type: string
        description: Key-Value metadata to store on payments created on this Payment Link
      url:
        type: string
        description: The URL for payment link
      status:
        type: string
        enum: [CREATED, PAID, EXPIRED]
        description: The status of payment link
      session_status:
        type: string
        enum: [OPEN,PROCESSING,COMPLETE,FAILED]
        description: The session status of payment link
      expires_at:
        type: string
        format: date-time
        description: Timestamp of when the payment link was or will expired in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      created_at:
        type: string
        format: date-time
        description: Timestamp of when the payment link was created in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      updated_at:
        type: string
        format: date-time
        description: Timestamp of when the payment link was last updated in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      payment:
        type: object
        $ref: "#/definitions/PaymentResponse"
      # yes, recipient, recipient_account and sender are the same as the one inside mandate, it's product requirement that they should also be in this level to be consistent.
      # if we couldnt get value from mandate, these will contain empty value.
      sender:
        type: object
        $ref: "#/definitions/PaymentLinkSenderResponse"
      payment_method:
        $ref: "#/definitions/PaymentMethodResponse"
      integration_metadata:
        $ref: "#/definitions/IntegrationMetadataResponse"

  # basically same as PaymentLinkSender but it also contain the user_id
  # MandateSender obj has no email, so creating new definition here
  PaymentLinkSenderResponse:
    properties:
      email:
        type: string
        format: email
      external_user_id:
        type: string
        description: Customer App's user ID, representing the end-user making the payment.
        minLength: 1
      name:
        type: string
        description: "Accountholder name of the sender's account"
        example: "Chan Li Pak"
        minLength: 1
      user_id:
        type: string
        description: A unique identifier generated after creating sender

  RapidstorMetadataRequest:
    properties:
      corp_code:
        type: string
      s_location_code:
        type: string
      tenant_id:
        type: string
      i_anniv_days:
        type: number
        format: int32
        minimum: 1
        maximum: 31
      account_token:
        type: string
        minimum: 1
      unit_type_id:
        type: string
    required:
      - corp_code
      - s_location_code
      - tenant_id
      - account_token

  RapidstorMetadataResponse:
    properties:
      corp_code:
        type: string
      s_location_code:
        type: string
      tenant_id:
        type: string
      i_anniv_days:
        type: number
        format: int32
      tenant_default_currency:
        type: string
      account_token:
        type: string
      unit_type_id:
        type: string

  IntegrationMetadataRequest:
    properties:
      integration_id:
        type: string
        enum: &INTEGRATION_ID ["RAPIDSTOR"]
      rapidstor_metadata:
        $ref: "#/definitions/RapidstorMetadataRequest"
    required:
      - integration_id

  IntegrationMetadataResponse:
    properties:
      integration_id:
        type: string
        enum: *INTEGRATION_ID
      rapidstor_metadata:
        $ref: "#/definitions/RapidstorMetadataResponse"

  Fee:
    properties:
      amount:
        type: integer
        example: 100
        description: The amount of fee for a single transaction. Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
      currency:
        type: string
        example: HKD
      paid_by:
        type: string
        example: RECIPIENT
        enum: [RECIPIENT, SENDER]
      paid_by_account_id:
        type: string
        description: The payment account Id
        example: The payment account ID
    required:
      - amount

  GetLineItemsForDisplayResponse:
    properties:
      line_items:
        type: array
        items:
          $ref: "#/definitions/LineItem"

  GetLineItemsForDisplayResponseV2:
    properties:
      line_items:
        type: array
        items:
          $ref: "#/definitions/LineItem"

  LineItem:
    properties:
      currency:
        type: string
      amount:
        type: string
        description: The amount in decimal
      item_type:
        type: string
        enum: [AMOUNT_DUE, SURCHARGE, TOTAL]

  SetMandateInstitutionRequest:
    properties:
      institution_id:
        type: string
        description: Finverse Institution ID
        maxLength: 100
    required:
      - institution_id

  SetMandateInstitutionResponse:
    properties:
      mandate_id:
        type: string
        description: Finverse Mandate ID
    required:
      - mandate_id

  FVCard:
    properties:
      created_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      updated_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      status:
        type: string
        description: Card Status
        enum: &CARD_STATUS ["UNKNOWN", "PROCESSING", "SUCCEEDED", "CANCELLED", "FAILED"]
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"
      card_details:
        $ref: "#/definitions/FVCardDetails"
      recipient_account:
        $ref: "#/definitions/MandateRecipientAccount"

  # Card details returned for API
  FVCardDetails:
    properties:
      brand:
        type: string
        description: The credit card brand
        example: VISA
      last4:
        type: string
        description: Last 4 digits of the credit card number
        example: "1234"
      expiry_month:
        type: integer
        description: The credit card expiry month
        example: 7
      expiry_year:
        type: integer
        description: The credit card expiry year
        example: 2028
      processor_entity_name: 
        type: string
      collection_entity_name: 
        type: string
      country:
        type: string
      fingerprint:
        type: string
      funding:
        type: string
        enum: &CARD_FUNDING_TYPE ["UNKNOWN", "CREDIT", "DEBIT", "PREPAID"]
      finverse_authorization_reference:
        type: string
      processor_details:
        x-nullable: true
        $ref: "#/definitions/FVCardProcessorDetails"
      recurring_payment_mode:
        type: string
        description: The recurring payment mode

  FVCardProcessorDetails:
    properties:
      auth_code:
        type: string
      processor_id: 
        type: string
      processor_reference:
        type: string
      token_id:
        type: string
      network_transaction_reference:
        type: string
        description: The network transaction reference

  GetMandateResponse:
    properties:
      created_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      updated_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      mandate_id:
        type: string
        description: Finverse Mandate ID (ULID)
      payment_method_id:
        type: string
        description: Finverse Payment Method ID (ULID)
      status:
        type: string
        description: Mandate Status
        enum:
          [
            "AUTHORIZATION_REQUIRED",
            "AUTHORIZING",
            "PROCESSING",
            "SUBMITTED",
            "SUCCEEDED",
            "FAILED",
            "REVOKED",
          ]
      recipient:
        $ref: "#/definitions/MandateRecipient"
      recipient_account:
        $ref: "#/definitions/MandateRecipientAccount"
      sender:
        $ref: "#/definitions/GetMandateSender"
      sender_account:
        $ref: "#/definitions/MandateSenderAccount"
      mandate_details:
        $ref: "#/definitions/MandateDetailsResponse"
      fees:
        type: array
        items:
          $ref: "#/definitions/Fee"
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"
      metadata:
        type: object
        additionalProperties:
          type: string
        description: "Additional attributes of the mandate in key:value format (e.g. mandate_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
    required:
      - updated_at
      - mandate_id
      - status
      - recipient
      - sender
      - mandate_details

  ListMandatesResponse:
    properties:
      mandates:
        type: array
        items:
          $ref: "#/definitions/GetMandateResponse"
      total_mandates:
        type: integer
    required:
      - total_mandates

  MandateRecipient:
    properties:
      name:
        type: string
        description: Merchant account name
    required:
      - name

  CardRecipient:
    properties:
      name:
        type: string
        description: Merchant account name

  MandateRecipientAccount:
    properties:
      account_id:
        type: string
        description: Merchant account ID assigned by Finverse
      account_type:
        type: string
        description: "Type of recipient account."
        example: "SETTLEMENT_ACCOUNT"
        enum: [EXTERNAL_ACCOUNT, SETTLEMENT_ACCOUNT]
    required:
      - account_id
      - account_type

  MandateRecipientRequest:
    properties:
      account_id:
        type: string
        description: Merchant account ID assigned by Finverse
        maxLength: 100
    required:
      - account_id

  MandateSenderAccountRequest:
    properties:
      account_id:
        type: string
        description: account ID assigned by Finverse
        maxLength: 100
    required:
      - account_id

  CreateMandateSender:
    properties:
      name:
        type: string
      external_user_id:
        type: string
        description: Customer App's user ID, representing the end-user making the payment.
      user_type:
        type: string
        description: Type of account held by the Sender at the Institution. Possible values are INDIVIDUAL, BUSINESS
        enum: &SENDER_TYPE ["INDIVIDUAL", "BUSINESS"]
      user_details:
        description: Sender details which will be used for fraud checking.
        type: array
        maxItems: 10
        items:
          $ref: "#/definitions/SenderDetail"

  GetMandateSender:
    properties:
      user_id:
        type: string
        description: A unique identifier generated after creating sender
      name:
        type: string
      external_user_id:
        type: string
        description: Customer App's user ID, representing the end-user making the payment.
      user_type:
        type: string
        description: Type of account held by the Sender at the Institution. Possible values are INDIVIDUAL, BUSINESS
        enum: ["INDIVIDUAL", "BUSINESS"]
      user_details:
        description: Sender details which will be used for fraud checking.
        type: array
        items:
          $ref: "#/definitions/SenderDetail"
    required:
      - user_id
      - external_user_id
      - user_type

  # this is mandate details that is returned by READ endpoint
  MandateDetailsResponse:
    properties:
      dda_reference:
        type: string
        description: The direct debit authorization reference, if empty this will be omitted from response
      currency:
        type: string
        description: ISO currency code
      start_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than or the same as the date of creation. If unspecified, default to the date of creation.
      end_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than the date of creation.
      payment_schedule:
        $ref: "#/definitions/PaymentSchedule"
        x-nullable: true
        description: Pre-scheduled payment details (only communicated to banks which require a specific payment schedule and amount when setting up a mandate).
      transaction_limits:
        $ref: "#/definitions/TransactionLimitsResponse"
        x-nullable: true
        description: Pre-set limits on the frequency and amounts of payments under this mandate.
      description:
        type: string
        description: End-user facing description of the mandate (used in notifications, and in payments if no description is provided)
      mandate_bank_reference:
        type: string
        description: A bank specific reference, what the end user may see
      processor_entity_name:
        type: string
      collection_entity_name:
        type: string
    required:
      - currency

  # this is mandate details that is passed when creating mandate
  MandateDetailsRequest:
    properties:
      currency:
        type: string
        description: ISO currency code
      start_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than or the same as the date of creation. If unspecified, default to the date of creation.
      end_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than the date of creation.
      payment_schedule:
        $ref: "#/definitions/PaymentSchedule"
        x-nullable: true
        description: Pre-scheduled payment details (only communicated to banks which require a specific payment schedule and amount when setting up a mandate).
      transaction_limits:
        $ref: "#/definitions/TransactionLimitsRequest"
        x-nullable: true
        description: Pre-set limits on the frequency and amounts of payments under this mandate.
      description:
        type: string
        description: End-user facing description of the mandate (used in notifications, and in payments if no description is provided)
      mandate_bank_reference:
        type: string
        description: A bank specific reference, what the end user may see
    required:
      - currency

  # this is mandate details that is passed when creating mandate with dda reference
  MandateDetailsRequestWithDdaReference:
    properties:
      dda_reference:
        type: string
        description: The direct debit authorization reference
      currency:
        type: string
        description: ISO currency code
      start_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than or the same as the date of creation. If unspecified, default to the date of creation.
      end_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than the date of creation.
      transaction_limits:
        $ref: "#/definitions/TransactionLimitsRequest"
        x-nullable: true
        description: Pre-set limits on the frequency and amounts of payments under this mandate.
      description:
        type: string
        description: End-user facing description of the mandate (used in notifications, and in payments if no description is provided)
    required:
      - currency
      - description

  MandateDetailsForPaymentLink:
    properties:
      start_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than or the same as the date of creation. If unspecified, default to the date of creation.
      end_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than the date of creation.
      transaction_limits:
        $ref: "#/definitions/TransactionLimitsResponse"
        x-nullable: true
        description: Pre-set limits on the frequency and amounts of payments under this mandate.
      description:
        type: string
        description: End-user facing description of the mandate (used in notifications, and in payments if no description is provided)

  MandateDetailsForPaymentLinkRequest:
    properties:
      start_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than or the same as the date of creation. If unspecified, default to the date of creation.
      end_date:
        type: string
        format: date
        x-nullable: true
        description: YYYY-MM-DD, must be later than the date of creation.
      transaction_limits:
        $ref: "#/definitions/TransactionLimitsRequest"
        x-nullable: true
        description: Pre-set limits on the frequency and amounts of payments under this mandate.
      description:
        type: string
        description: End-user facing description of the mandate (used in notifications, and in payments if no description is provided)

  SenderDetail:
    properties:
      details_type:
        type: string
        description: The type of the details. For e.g. HK_ID, PASSPORT etc
        enum:
          [
            "HK_ID",
            "PASSPORT",
            "HK_BUSINESS_REGISTRATION",
            "HK_CERTIFICATE_OF_INCORPORATION",
          ]
      values:
        description: The possible values of the detail. For e.g. A123456 for HK_ID
        type: array
        maxItems: 10
        items:
          type: string

  PaymentSchedule:
    properties:
      amount:
        type: integer
        example: 100
        description: Amount to be paid, in currencys smallest unit or minor unit, as defined in ISO 4217. For example, HKD 100.01 is represented as amount = 10001 (minor unit = cents). For currencies without minor units (e.g. VND, JPY), the amount is represented as is, without modification. For example, VND 15101 is represented as amount = 15101.
      frequency:
        type: string
        description: Frequency of the payment. Possible values (DAILY, WEEKLY, MONTHLY, QUARTERLY, YEARLY)
        enum: ["DAILY", "WEEKLY", "MONTHLY", "QUARTERLY", "YEARLY"]
    required:
      - amount
      - frequency

  TransactionLimitsRequest:
    properties:
      max_period_amount:
        type: integer
        description: Maximum amount of money that can be paid during the reference period (across any number of transactions). Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
        minimum: 1
      max_period_count:
        type: integer
        description: Maximum number of transactions (of any amount) that can be executed during the reference period.
        minimum: 1
      max_transaction_amount:
        type: integer
        description: The maximum amount of money that can be transferred in a single transaction under this mandate. Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
        minimum: 1
      period:
        type: string
        x-nullable: true
        description: Reference calendar periods for the payment limits. Possible values (DAILY, WEEKLY, MONTHLY, QUARTERLY, YEARLY)
        enum: ["DAILY", "WEEKLY", "MONTHLY", "QUARTERLY", "YEARLY"]
    required:
      - max_transaction_amount

  TransactionLimitsResponse:
    properties:
      max_period_amount:
        type: integer
        description: Maximum amount of money that can be paid during the reference period (across any number of transactions). Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
        minimum: 1
      max_period_count:
        type: integer
        description: Maximum number of transactions (of any amount) that can be executed during the reference period.
        minimum: 1
      max_transaction_amount:
        type: integer
        description: The maximum amount of money that can be transferred in a single transaction under this mandate. Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
        minimum: 1
      max_transaction_amount_set_by_payer_initial:
        type: integer
        x-nullable: true
        description: The maximum amount of money that can be transferred in a single transaction under this mandate set by the payer. Expressed in currency's smallest unit or minor unit, as defined in ISO 4217.
      period:
        type: string
        x-nullable: true
        description: Reference calendar periods for the payment limits. Possible values (DAILY, WEEKLY, MONTHLY, QUARTERLY, YEARLY)
        enum: ["DAILY", "WEEKLY", "MONTHLY", "QUARTERLY", "YEARLY"]
    
  GetMandateAuthLinkResponse:
    properties:
      access_token:
        type: string
        description: Short-lived access-token to interact with Finverse Link
      expires_in:
        type: integer
        description: Access token validity duration (in seconds)
      link_url:
        type: string
        description: URL to launch Finverse Link to authorize the mandate
      token_type:
        type: string
        enum: ["Bearer"]
    required:
      - access_token
      - expires_in
      - link_url
      - token_type

  GetMandateAuthLinkRequest:
    properties:
      mandate_id:
        type: string
        description: Mandate ID
        maxLength: 100
      link_customizations:
        $ref: "#/definitions/MandateAuthLinkCustomizations"
    required:
      - mandate_id
      - link_customizations

  # This guy is a subset and only has certain customizations enabled at the moment
  # See: https://www.notion.so/finverse/Finverse-Link-support-iFrame-option-for-Payment-Links-83231ea3946242008acbf9d24c08feda?pvs=4#8bf44dbe4f1540448880873f74d41074
  PaymentLinkCustomizations:
    properties:
      language:
        type: string
        description: ISO639-1 language code. Language to display when user open the link, default to English (en) if not specified
        example: en
        enum: *LANGUAGE
      ui_mode:
        type: string
        enum: *UI_MODE
        description: The UI mode link is intended to be used in - "iframe", "auto_redirect", "redirect" or "standalone"
        example: "redirect"
      redirect_uri:
        type: string
        description: URI to redirect to. Only needed if ui_mode = redirect

  MandateAuthLinkCustomizations:
    properties:
      countries:
        type: array
        items:
          type: string
        description: institution's country filter
        example: ["HKG", "SGP"]
      institution_id:
        type: string
        description: Institution to preselect
        example: hsbc-hk
      institution_status:
        type: string
        description: institution's status filter
        example: "alpha beta supported"
      language:
        type: string
        description: ISO639-1 language code. Language to display when user open the link, default to English (en) if not specified
        example: en
        enum: *LANGUAGE
      link_mode:
        type: string
        description: Space separated list of the tags of the institutions to view.
        example: real
      products_supported:
        type: array
        items:
          type: string
        description: institution's supported product filter. For mandate authorization, this field should contain ["MANDATE"]
        example: ["ACCOUNTS", "TRANSACTIONS", "MANDATE"]
      ui_mode:
        type: string
        enum: *UI_MODE
        description: The UI mode link is intended to be used in - "iframe", "auto_redirect", "redirect" or "standalone"
        example: "redirect"
      redirect_uri:
        type: string
        description: The URI to redirect to. Required if ui_mode is "redirect" or "auto_redirect"
      user_type:
        type: array
        items:
          type: string
        description: institution's supported user_type filter
        example: ["PERSONAL"]

  GetMandateAuthResponse:
    properties:
      mandate_id:
        type: string
        description: Finverse Mandate ID
      mandate_status:
        type: string
        description: Mandate status
        enum: ["CREATED", "PROCESSING", "SUBMITTED", "ERROR"]
      recipient_account_id:
        type: string
        description: Merchant account ID assigned by Finverse
      institution_id:
        type: string
        description: Finverse Institution ID. Only returned if institution_id was included in the request.
      sender_type:
        type: string
        description: Type of account held by the Sender at the Institution. Possible values are INDIVIDUAL, BUSINESS
        enum: ["INDIVIDUAL", "BUSINESS"]
      auth_checklist:
        description: Checklist of the authorization factors needed to complete Mandate authorization
        type: array
        items:
          $ref: "#/definitions/AuthChecklistFactor"
      encryption_info:
        description: Encryption_info used in the POST. The object contains the key_id and the URL where the key is hosted.
        $ref: "#/definitions/MandateAuthEncryptionInfo"
      last_update:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"
      mandate_details:
        $ref: "#/definitions/MandateDetailsResponse"
      recipient:
        $ref: "#/definitions/MandateRecipient"
    required:
      - mandate_id
      - mandate_status
      - recipient_account_id
      - institution_id
      - auth_checklist
      - encryption_info
      - last_update

  MandateAuthEncryptionInfo:
    properties:
      jwks_url:
        type: string
      key_id:
        type: string
    required:
      - jwks_url
      - key_id

  AuthChecklistFactor:
    properties:
      type:
        type: string
        description: Type of authorization factor
        enum:
          [
            "ACCOUNT_IDENTIFICATION",
            "USER_IDENTIFICATION",
            "ENDUSER_CONSENT",
            "ACCOUNTHOLDER_AUTHENTICATION",
          ]
      group_id:
        type: string
        description: Allows grouping similar checklist item types together
      required:
        type: string
        description: Indicates whether authorization factor is known to be required at this time.  Possible values are YES, NO, OPTIONAL
        enum: ["YES", "NO", "OPTIONAL"]
      helper_text:
        type: string
        description: Helper text that applies to a specific checklist item
      options:
        description: Array of the options accepted for a specific authorization factor
        type: array
        items:
          $ref: "#/definitions/AuthChecklistOptions"
    required:
      - type
      - group_id
      - required
      - options

  AuthChecklistOptions:
    properties:
      name:
        type: string
        description: Name of authorization factor. Possible values are INSTITUTION_CREDENTIALS_LOGIN, INSTITUTION_OAUTH_LOGIN,
        enum: ["INSTITUTION_CREDENTIALS_LOGIN", "INSTITUTION_OAUTH_LOGIN"]
      submitted_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ) for when the authorization factor was submitted to Finverse
        x-nullable: true
      submitted_by:
        type: string
        description: Indicates who submitted the authorization factor to Finverse. Possible values are CUSTOMER_APP, FINVERSE_LINK
        enum: ["CUSTOMER_APP", "FINVERSE_LINK"]
      redirect_url:
        type: string
        description: Redirect to bank for authentication
    required:
      - name

  SubmitAuthChecklistResponse:
    properties:
      mandate_id:
        type: string
        description: Finverse Mandate ID
      auth_checklist:
        description: Checklist of the authorization factors needed to complete Mandate authorization
        type: array
        items:
          $ref: "#/definitions/AuthChecklistFactor"
      mandate_status:
        type: string
        description: Mandate status
        enum: ["CREATED", "PROCESSING", "SUBMITTED", "ERROR"]
      last_update:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
    required:
      - mandate_id
      - auth_checklist
      - mandate_status
      - last_update

  AuthorizeMandateRequest:
    properties:
      enduser_consent:
        type: boolean
        description: Whether a consent was provided by the enduser to authorize a mandate
    required:
      - enduser_consent

  SubmitAuthChecklistRequest:
    properties:
      key_id:
        type: string
        description: The key_id that was used to encrypt the envelope key
        maxLength: 100
      envelope_encryption_key:
        type: string
        description: The encrypted envelope key
        maxLength: 1000
      initialization_vector:
        type: string
        description: The initialization vector used for enncrypting the payload
        maxLength: 100
      message_authentication_code:
        type: string
        description: The authentication code is used to authenticate the origin of the message
        maxLength: 100
      ciphertext:
        type: string
        description: The encrypted payload that contains auth checklist items
    required:
      - key_id
      - envelope_encryption_key
      - initialization_vector
      - message_authentication_code
      - ciphertext

  CreateRecipientAccount:
    type: object
    properties:
      accountholder_name:
        type: string
        description: "Accountholder name of the recipient's account"
        example: "Chan Li Pak"
      account_number:
        $ref: "#/definitions/RecipientAccountNumber"
        description: "Account number of the recipients account. See below."
      account_type:
        type: string
        description: "Type of recipient account."
        example: "EXTERNAL_ACCOUNT"
        enum: [EXTERNAL_ACCOUNT]
      currencies:
        type: array
        items:
          type: string
        description: "List of currencies supported by the recipient account"
        example: ["HKD", "SGD"]
      institution_id:
        type: string
        description: "Finverse Institution ID for the recipients institution."
        example: "hsbc-hk"
    required:
      - accountholder_name
      - account_number
      - account_type
      - currencies
      - institution_id

  RecipientAccountResponse:
    type: object
    properties:
      recipient_account_id:
        type: string
        description: A unique identifier generated after creating recipient
      accountholder_name:
        type: string
        description: "Accountholder name of the recipient's account"
        example: "Chan Li Pak"
      account_number:
        $ref: "#/definitions/RecipientAccountNumber"
        description: "Account number of the recipients account. See below."
      account_type:
        type: string
        description: "Type of recipient account."
        example: "EXTERNAL_ACCOUNT"
        enum: [EXTERNAL_ACCOUNT, SETTLEMENT_ACCOUNT]
      currencies:
        type: array
        items:
          type: string
        description: "List of currencies supported by the recipient account"
        example: ["HKD", "SGD"]
      institution_id:
        type: string
        description: "Finverse Institution ID for the recipients institution."
        example: "hsbc-hk"
      institution_name:
        type: string
        description: "Institution Name for the senders institution."
        example: "HSBC"
      bank_code:
        type: string
        description: "3-digit code associated with bank"
        example: "004"
      branch_code:
        type: string
        description: "3-digit code used to identify specific bank branch"
        example: "123"

  RecipientAccountNumber:
    type: object
    properties:
      type:
        type: string
        description: "Type of account number. Possible values: LOCAL, IBAN"
        enum: [LOCAL, IBAN]
      number:
        type: string
        description: "Account number value"
        minLength: 1
        maxLength: 100
      number_plaintext:
        type: string
        description: "Account number value"
        minLength: 1
        maxLength: 100
        x-nullable: true
    required:
      - type
      - number

  MandateSenderAccount:
    type: object
    properties:
      account_id:
        type: string
        description: "A unique identifier generated after creating sender account"
        example: "sender_account_id"
      accountholder_name:
        type: string
        description: "Tokenized accountholder name of the sender's account"
        example: "01EP4A1MZDHKETZFRPF0K62S6S"
      accountholder_name_plaintext:
        type: string
        description: "Accountholder name of the sender's account in plain text"
        example: "Chan Li Pak"
        x-nullable: true
      account_number:
        $ref: "#/definitions/RecipientAccountNumber"
        description: "Account number of the senders account. See below."
      account_number_masked:
        type: string
        description: "Masked Account number of the senders account"
      account_type:
        type: string
        description: "Type of sender account."
        example: "EXTERNAL_ACCOUNT"
        enum: [EXTERNAL_ACCOUNT]
      institution_id:
        type: string
        description: "Finverse Institution ID for the senders institution."
        example: "hsbc-hk"
      institution_name:
        type: string
        description: "Institution Name for the senders institution."
        example: "HSBC"
      user_id:
        type: string
        description: "A unique identifier generated after creating sender (Finverse Payment User ID)"
        example: "01GY6H0JA7BS8EVGY56NSHFX2E"
      bank_code:
        type: string
      metadata:
        type: object
        additionalProperties:
          type: string
        description: "Additional attributes of the sender account in key:value format (e.g. sender_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."

  GetPaymentUserResponse:
    type: object
    properties:
      payment_user_id:
        type: string
      customer_app_id:
        type: string
      # Should not have name and other details here because that would allow a link token holder
      # to use response data and bypass the fraud check
      autopay_consent:
        type: boolean
        description: "The user's current autopay value"
      autopay_prefill:
        type: boolean
        description: "This indicates the value that the user's pre-set selection should be. If this is a new user, the value will be set to true by default, else it will be the user's current autopay value."
    required:
      - payment_user_id
      - customer_app_id
      - autopay_consent
      - autopay_prefill

  SetAutopayConsentRequest:
    type: object
    properties:
      autopay_consent:
        type: boolean
    required:
      - autopay_consent

  FpsQrCodeResponse:
    type: object
    properties:
      qr_code:
        type: string
        description: The FPS QR code in base64
    required:
      - qr_code

  ManualPaymentConfirmationRequest:
    type: object
    properties:
      accountholder_name:
        type: string
        maxLength: 1024
        description: Required if manual payment provider is HK_FPS. Not required for SG_PAYNOW

  ManualPaymentConfirmationResponse:
    type: object
    properties:
      payment_id:
        type: string
      status:
        type: string
        enum: *PAYMENT_STATUS

  ListPaymentAccountsResponse:
    properties:
      payment_accounts:
        type: array
        items:
          $ref: "#/definitions/PaymentAccountDetails"

  ListPaymentAccountsWithEnrichedDataResponse:
    properties:
      payment_accounts:
        type: array
        items:
          $ref: "#/definitions/PaymentAccountDetailsWithEnrichedData"
      total:
        type: integer
        description: Total number of matching payment accounts

  PaymentAccountDetailsWithEnrichedData:
    allOf:
    - $ref: "#/definitions/PaymentAccountDetails"
    - type: object
      properties:
        payment_method_overview:
          $ref: "#/definitions/PaymentMethodOverview"

  PaymentAccountDetails:
    properties:
      account_id:
        type: string
        description: Payment account id
      account_number:
        $ref: "#/definitions/RecipientAccountNumber"
        description: Account number of the payment account
      account_number_masked:
        type: string
        description: Masked Account number of the payment account
      account_type:
        type: string
        description: "Type of payment account."
        example: "EXTERNAL_ACCOUNT"
        enum: [EXTERNAL_ACCOUNT, SETTLEMENT_ACCOUNT]
      accountholder_name:
        type: string
        description: "Accountholder name of the payment account"
        example: "Chan Li Pak"
      customer_app_id:
        type: string
        description: "The customer app ID"
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      institution_id:
        type: string
        description: "Finverse Institution ID for the payment institution."
        example: "hsbc-hk"
      institution_name:
        type: string
        description: "Institution Name for the senders institution."
        example: "HSBC"
      user_id:
        type: string
        description: "A unique identifier generated after creating user (Finverse Payment User ID)"
        example: "01GY6H0JA7BS8EVGY56NSHFX2E"
      bank_code:
        type: string
        description: "3-digit code associated with bank"
        example: "004"
      branch_code:
        type: string
        description: "3-digit code used to identify specific bank branch"
        example: "123"
      currencies:
        type: array
        items:
          type: string
        description: "List of currencies supported by the payment account"
        example: ["HKD", "SGD"]
        x-omitempty: true
      business_units:
        type: array
        items:
          type: string
        description: The business units the payment account belongs to
      legal_entity_name:
        type: string
        description: This field is only applicable to settlement account
      metadata:
        type: object
        additionalProperties:
          type: string
        description: "Additional attributes of the sender account in key:value format (e.g. sender_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
      created_at:
        type: string
        format: date-time
        description: Timestamp of when the payment link was created in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      updated_at:
        type: string
        format: date-time
        description: Timestamp of when the payment link was last updated in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)

  PaymentMethodOverview:
    properties:
      external_gateway:
        type: string
        description: STRIPE, CYBERSOURCE, UOB, DBS (only shown when payment flows funds via a 3rd party gateway direct to the customer)
      payment_confirmation_speed:
        type: string
        description: It can be either REALTIME or DELAYED
      payment_method_type:
        type: string
        description: The payment method type, possible values CARD, MANDATE and MANUAL
      payment_method_subtype:
        type: string
        description: The payment method subtype, e.g., EDDA_HK, CARD_GENERIC etc
      payment_processor:
        type: string
        description: Only shown if funds flow via Finverse, possible values FINVERSE
      live_mode:
        type: boolean
        description: Whether the payment method can move real money or not
      supported_currencies:
        type: array
        example: [HKD, CNY]
        description: Shows which currencies are supported
        items:
          type: string
    required:
      - live_mode


  CreatePaymentAccountRequest:
    properties:
      account_number:
        $ref: "#/definitions/RecipientAccountNumber"
        description: Account number of the payment account
      account_type:
        type: string
        description: "Type of payment account. Currently only allow creating external account."
        example: "EXTERNAL_ACCOUNT"
        enum: [EXTERNAL_ACCOUNT]
      accountholder_name:
        type: string
        description: "Accountholder name of the payment account"
        example: "Chan Li Pak"
      currencies:
        type: array
        items:
          type: string
          maxLength: 3
        description: "List of currencies supported by the payment account"
        example: ["HKD", "SGD"]
      institution_id:
        type: string
        description: "Finverse Institution ID for the payment institution."
        example: "hsbc-hk"
        maxLength: 100
      user_id:
        type: string
        description: "A unique identifier generated after creating user (Finverse Payment User ID)"
        example: "01GY6H0JA7BS8EVGY56NSHFX2E"
        maxLength: 100
      metadata:
        $ref:  "#/definitions/CreateMetadata"
        description: "Additional attributes of the payment in key:value format (e.g. payment_internal_id: 1234). It supports up to 10 key:value pairs, whereas the key and value supports up to 50 and 1000 characters respectively."
    required:
      - account_number
      - account_type
      - accountholder_name
      - institution_id
      - user_id

  CreatePaymentUserRequest:
    properties:
      name:
        type: string
        maxLength: 100
      external_user_id:
        type: string
        maxLength: 100
      user_type:
        type: string
        enum: *SENDER_TYPE
      email:
        type: string
        maxLength: 256 # is max as specified in RFC 5321
      user_details:
        type: array
        items:
          $ref: "#/definitions/SenderDetail"
      metadata:
        $ref:  "#/definitions/CreateMetadata"
      autopay_consent:
        type: boolean
      integration_metadata:
        $ref: "#/definitions/IntegrationMetadataRequest"
    required:
      - name
      - external_user_id

  UpdatePaymentUserRequest:
    properties:
      autopay_consent:
        type: boolean
        x-nullable: true
      email:
        type: string
        maxLength: 256 # is max as specified in RFC 5321
        x-nullable: true
      metadata:
        type: object
        additionalProperties:
          type: string
        x-nullable: true
      name:
        type: string          
        x-nullable: true
      next_bill_update:
        type: string
        format: date-time
        x-nullable: true        
      user_type:
        type: string
        enum: *SENDER_TYPE
        x-nullable: true  
    additionalProperties: true

  PaymentUser:
    properties:
      created_at:
        type: string
        format: date-time
      email:
        type: string
      external_user_id:
        type: string
      metadata:
        type: object
        additionalProperties:
          type: string
      name:
        type: string
      user_details:
        type: array
        items:
          $ref: "#/definitions/SenderDetail"
      updated_at:
        type: string
        format: date-time
      next_bill_update:
        type: string
        format: date-time
        x-nullable: true
      user_id:
        type: string
      user_type:
        type: string
        enum: *SENDER_TYPE
      autopay_consent:
        type: boolean
        example: false
        description: Whether the user has given consent for autopay
      integration_metadata:
        $ref: "#/definitions/IntegrationMetadataResponse"
    required:
      - autopay_consent

  # Should return this model for all endpoints except /payment_users/{id}
  PaymentUserWithoutEmail:
    properties:
      created_at:
        type: string
        format: date-time
      email:
        type: string
      external_user_id:
        type: string
      metadata:
        type: object
        additionalProperties:
          type: string
      name:
        type: string
      user_details:
        type: array
        items:
          $ref: "#/definitions/SenderDetail"
      updated_at:
        type: string
        format: date-time
      next_bill_update:
        type: string
        format: date-time
        x-nullable: true
      user_id:
        type: string
      user_type:
        type: string
        enum: *SENDER_TYPE
      autopay_consent:
        type: boolean
        example: false
        description: Whether the user has given consent for autopay
      integration_metadata:
        $ref: "#/definitions/IntegrationMetadataResponse"
    required:
      - autopay_consent

  CreatePaymentMethodRequest:
    properties:
      card:
        $ref: "#/definitions/CreateCardRequest"
      mandate:
        $ref: "#/definitions/CreateMandateRequestWithDdaReference"
      integration_metadata:
        $ref: '#/definitions/PaymentMethodIntegrationMetadata'
      payment_method_type:
        type: string
        enum:
          - "CARD"
          - "MANDATE"
    required:
      - payment_method_type

  # not to be confused with FvBill/Payment Links related integration metadata
  PaymentMethodIntegrationMetadata:
    properties:
      integration_id:
        type: string
        enum:
          - "STRIPE" 
          - "CYBERSOURCE"
          - "ADYEN"
      stripe_metadata:
        type: object
        properties:
          customer:
            type: object
            properties: 
              id:
                type: string
            required:
              - id
          payment_method:
            type: object
            properties: 
              id:
                type: string
            required:
              - id
        required:
          - customer
          - payment_method
      cybersource_metadata:
        type: object
        properties:
          payment_token:
            type: string
        required:
          - payment_token 
      adyen_metadata:
        type: object
        properties:
          payment_method_id:
            type: string
          auth_code:
            type: string
          psp_reference:
            type: string
          recurring_processing_model:
            type: string
            enum:
            - "CardOnFile" 
            - "UnscheduledCardOnFile"
            - "Subscription"
          network_transaction_reference:
            type: string
        required:
          - payment_method_id 
    required:
      - integration_id

  # we use this model when payment method is nested
  PaymentMethodResponse:
    properties:
      payment_method_id:
        type: string
      payment_method_type:
        type: string
      mandate:
        $ref: "#/definitions/GetMandateResponse"
      card:
        $ref: "#/definitions/FVCard"
      integration_metadata:
        $ref: '#/definitions/PaymentMethodIntegrationMetadata'

  # Payment method that is safe to return to the front end (i.e. non-sensitive fields)
  PaymentMethodFvLinkResponse:
    properties:
      payment_method_id:
        type: string
      payment_method_type:
        type: string
      recipient_entity_name:
        type: string
      mandate:
        $ref: "#/definitions/MandateFvLinkResponse"
      card:
        $ref: "#/definitions/CardFvLinkResponse"
  
  AvailablePaymentMethodsFvLinkResponse:
    properties:
      available_payment_methods:
        type: array
        items:
          $ref: "#/definitions/AvailablePaymentMethod"

  AvailablePaymentMethod:
    properties:
      payment_account_id:
        type: string
      payment_method_type:
        type: string
        description: The payment method type, possible values CARD, MANDATE and MANUAL
      payment_method_subtype:
        type: string
        description: The payment method subtype, e.g., EDDA_HK, CARD_GENERIC etc
      recurring:
        type: boolean
      fee:
        type: string
      payment_method_provider:
        type: string
    required:
      - recurring

  # Payment that is safe to return to the front end (i.e. non-sensitive fields)
  PaymentFvLinkResponse:
    properties:
      payment_id:
        type: string
      status: 
        type: string
        enum: *PAYMENT_STATUS
      type:
        type: string
        enum: *PAYMENT_TYPE
      payment_details:
        $ref: "#/definitions/PaymentFvLinkDetails"
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"

  # Payment details that are safe to return to the front-end (i.e. non-sensitive fields)
  PaymentFvLinkDetails:
    properties:
      collection_entity_name:
        type: string

  MandateFvLinkResponse:
    properties:
      mandate_id:
        type: string
      institution_id:
        type: string
      mandate_status:
        type: string
      recipient:
        $ref: "#/definitions/MandateRecipient"
      sender_account:
        $ref: "#/definitions/SenderAccountFvLinkResponse"
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"
      mandate_details:
        $ref: "#/definitions/MandateFvLinkDetails"

  MandateFvLinkDetails:
    properties:
      collection_entity_name: 
        type: string

  CardFvLinkResponse:
    properties:
      status:
        type: string
        enum: *CARD_STATUS
      card_details:
        $ref: "#/definitions/CardFvLinkDetails"
      recipient:
        $ref: "#/definitions/CardRecipient"
      error:
        $ref: "#/definitions/FvEmbeddedErrorModel"

  # Card details returned for FE (which may be different to what is returned to BE)
  CardFvLinkDetails:
    properties:
      brand:
        type: string
        description: The credit card brand
        example: VISA
      last4:
        type: string
        description: Last 4 digits of the credit card number
        example: "1234"
      expiry_month:
        type: integer
        description: The credit card expiry month
        example: 7
      expiry_year:
        type: integer
        description: The credit card expiry year
        example: 2028
      collection_entity_name: 
        type: string
      

  SenderAccountFvLinkResponse:
    properties:
      account_number_masked:
        type: string
      institution_id:
        type: string
      institution_name:
        type: string

  ChangePaymentMethodFvLinkResponse:
    properties:
      redirect_url:
        type: string
  
  # temporary struct to represent a payment method on a payment snapshot. End goal is to have the actual payment_method here
  PaymentSnapshotPaymentMethod:
    properties:
      card:
        properties:
          card_details:
            $ref: "#/definitions/FVCardDetails"
      
  RefreshPaymentAttemptResponse:
    properties:
      redirect_url:
        type: string


  CreateCardRequest:
    properties:
      card_details:
        type: object
        properties:
          brand: 
            type: string
          last4:
            type: string
          currency:
            type: string
          expiry_month:
            type: integer
          expiry_year:
            type: integer
        required:
          - brand
          - last4
          - currency
      recipient_account:
        $ref: "#/definitions/MandateRecipientRequest"
        description: The recipient (Settlement) account associated with this payment method
      status:
        type: string
        enum:
          - "SUCCEEDED"
    required:
      - card_details
      - status
      - recipient_account

  RefreshLoginIdentityLinkCustomizations:
    properties:
      language:
        type: string
        enum: *LANGUAGE
        description: ISO639-1 language code. Language to display when user open the link, default to English (en) if not specified
        example: en
      ui_mode:
        type: string
        enum: *UI_MODE
        example: redirect
      redirect_uri:
        type: string
        description: Required if ui_mode is redirect or auto_redirect
      state:
        type: string
        example: user-state-passed
        maxLength: 100
  
  RefreshLoginIdentityRequest:
    properties:
      user_present:
        type: boolean
        description: Indicate whether the user is present in this flow. If the user is not present, only institutions that do not require 2fa can be refreshed
      link_customizations:
        $ref: "#/definitions/RefreshLoginIdentityLinkCustomizations"

  DownloadBalanceStatementResponse:
    properties:
      download_url:
        type: string
        description: Signed URL to download the CSV from
    required:
      - download_url

  DisputeResponse:
    type: object
    properties:
      dispute_id:
        type: string
        description: The dispute id
      amount:
        type: integer
        description: Amount to be disputed, in currency's smallest unit or minor unit, as defined in ISO 4217. For example, HKD 100.01 is represented as amount = 10001 (minor unit = cents). For currencies without minor units (e.g. VND, JPY), the amount is represented as is, without modification. For example, VND 15101 is represented as amount = 15101.
      currency:
        type: string
        example: "HKD"
        description: The currency of the balance
      last_event_name:
        type: string
        description: The name of the last event for this dispute
      payment_id: 
        type: string
        description: The payment id
      payment_processor:
        type: string
        example: "ADYEN"
        description: The payment processor handling the dispute
      payment_processor_merchant_reference:
        type: string
      payment_reference:
        type: string
        description: The payment reference for the disputed transaction
      payment_processor_payment_reference:
        type: string
        description: The payment processor's payment reference
      card_details:
        type: object
        properties:
          brand:
            type: string
            example: "visa"
      payment_processor_dispute_reference:
        type: string
        description: The payment processor's dispute reference
      payment_processor_dispute_reason:
        type: string
        description: The reason for the dispute as provided by the payment processor
      arn:
        type: string
        description: Acquirer Reference Number
      payment_processor_dispute_code:
        type: string
        description: The dispute code from the payment processor
      is_defendable:
        type: boolean
        description: Whether the dispute is defendable
        x-nullable: true
      dispute_status:
        type: string
        description: The status of the dispute
        enum:
          &DISPUTE_STATUS [
            "UNKNOWN",
            "UNDEFENDED",
            "ACTION_REQUIRED",
            "PROCESSING",
            "ACCEPTED",
            "LOST",
            "WON"
          ]
      payment_processor_dispute_status:
        type: string
        description: The status of the dispute at the payment processor
      is_auto_defended:
        type: boolean
        description: Whether the dispute was automatically defended
        x-nullable: true
      defense_period_deadline:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
        x-nullable: true
      issuer_comments:
        type: object
        additionalProperties:
          type: string
      created_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
      updated_at:
        type: string
        format: date-time
        description: Timestamp in ISO format (YYYY-MM-DDTHH:MM:SS.SSSZ)
  
  ListDisputesResponse:
    properties:
      disputes:
        type: array
        items:
          $ref: "#/definitions/DisputeResponse"
      total_disputes:
        type: integer
    required:
      - total_disputes
      - disputes

  CompleteKcpPaymentRequest:
    properties:
      lang:
        type: string
      res_cd:
        type: string
        description: Result code, "0000" if the payment is successful
      res_msg:
        type: string
        description: Result message
      buyr_mail:
        type: string
        description: Buyer's mail
      tran_cd:
        type: string
        description: Transaction code
      trace_no:
        type: string
        description: Trace number
      ret_pay_method:
        type: string
      use_pay_method:
        type: string
      enc_data:
        type: string
      enc_info:
        type: string
      ordr_idxx:
        type: string
        description: FV Payment ID
      card_pay_method:
        type: string
        description: Card payment method
      card_point_use:
        type: string
        description: If card point is used
        enum: ["Y", "N"]
      kcp_select_card_code:
        type: string
        description: KCP select card code
        example: CCXB
      ordr_chk:
        type: string
        description: In the format of "[FV Payment ID]|[Amount]"
    required:
      - tran_cd
      - enc_data
      - enc_info
      - ordr_idxx
      
  CompleteKcpPaymentResponse:
    properties:
      redirect:
        type: string
        description: retryUrl from the token's claims
    required:
      - redirect

  SelectPaymentMethodRequest:
    properties:
      payment_account_id:
        type: string
        description: The payment account ID of the selected payment method
        example: 01ARZ3NDEKTSV4RRFFQ69G5FAV
      payment_method_type:
        type: string
        description: The type of payment method to select
        enum: *PAYMENT_TYPE
      sender_type:
        type: string
        enum: *SENDER_TYPE
      is_mobile:
        type: boolean
        description: Whether the user is on mobile device (only makes a difference if payment_method_provider is KCP)
        default: false
    required:
      - payment_account_id
      - payment_method_type

  SelectPaymentMethodResponse:
    properties:
      token:
        $ref: "#/definitions/PaymentLinkTokenResponse"
        description: Token for the selected payment method
        x-nullable: true
      card_processor_redirect_uri:
        type: string
        description: URL to redirect to for making the card payment

paths:
  /jwks:
    get:
      description: get jwks
      operationId: getCredSubmitJwks
      security: []
      produces:
        - application/json
      responses:
        "200":
          description: ok
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModel"
      tags:
        - public

  /auth/customer/token:
    post:
      description: generate an access_token
      operationId: generateCustomerAccessToken
      security: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: tokenRequest
          description: token request
          schema:
            $ref: "#/definitions/TokenRequest"
      responses:
        "200":
          description: ok
          schema:
            $ref: "#/definitions/TokenResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - public

  /accounts/{accountId}:
    get:
      description: Get a specific account's information
      operationId: getAccount
      security:
        - Oauth2: [account]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetAccountResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: accountId
          description: The account id
          required: true
          type: string
      tags:
        - login_identity

  /accounts:
    get:
      description: Get a list of accounts for a login identity
      operationId: listAccounts
      security:
        - Oauth2: [account]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListAccountsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - login_identity

  /card_details:
    get:
      description: Get a list of card details for a login identity
      operationId: listCardDetails
      security:
        - Oauth2: [card:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListCardsDetailsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - login_identity

  /account_numbers/{accountId}:
    get:
      description: Get the account number for a specific account
      operationId: getAccountNumber
      security:
        - Oauth2: [account_number]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetAccountNumberResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: accountId
          description: The account id
          required: true
          type: string
      tags:
        - login_identity

  /balance_history/{accountId}:
    get:
      description: Get the balance history for a specific account
      operationId: getBalanceHistory
      security:
        - Oauth2: [balance_history]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetBalanceHistoryResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: accountId
          description: The account id
          required: true
          type: string
        - in: query
          name: source
          description: The source will determine what type of balance history will be returned
          type: string
          enum: [INSTITUTION, COMPUTED]
      tags:
        - login_identity

  /transactions/{accountId}:
    get:
      description: Get a list of transactions for a particular account. The transactions are returned in sorted order, with the most recent one appearing first.
      operationId: listTransactionsByAccountId
      security:
        - Oauth2: [transaction]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListTransactionsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: accountId
          description: The account id (ULID, example - 01EP4A1MZDHKETZFRPF0K62S6S)
          required: true
          type: string
        - in: query
          name: offset
          description: default is 0
          required: false
          type: integer
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          required: false
          type: integer
          default: 500
          minimum: 1
          maximum: 1000
        - in: query
          name: enrichments
          description: when true, response will be enriched transactions; otherwise it will be raw transactions
          required: false
          type: boolean
          default: false
      tags:
        - login_identity

  /transactions:
    get:
      description: Get a list of transactions for a login identity. The transactions are returned in sorted order, with the most recent one appearing first.
      operationId: listTransactionsByLoginIdentityId
      security:
        - Oauth2: [transaction]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListTransactionsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: query
          name: offset
          description: default is 0
          required: false
          type: integer
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          required: false
          type: integer
          default: 500
          minimum: 1
          maximum: 1000
        - in: query
          name: enrichments
          description: when true, response will be enriched transactions; otherwise it will be raw transactions
          required: false
          type: boolean
          default: false
      tags:
        - login_identity

  /income:
    get:
      description: Get income figures for a login identity
      operationId: getIncomeEstimateByLoginIdentityId
      security:
        - Oauth2: [income:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/IncomeResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - login_identity

  /institutions/{institutionId}:
    get:
      description: Get a specific institution by institutionId
      operationId: getInstitution
      security:
        - Oauth2: [institution]
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/Institution"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: institutionId
          description: The institution id
          required: true
          type: string
      tags:
        - customer

  /institutions:
    get:
      description: Get a list of institutions
      operationId: listInstitutions
      security:
        - Oauth2: [institution]
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/ListInstitutionsResponse"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        # Probably we want to remove the filtering options since we do not want it
        - in: query
          name: country
          description: (Deprecated) The country the institution belongs to
          required: false
          type: string
        - in: query
          name: countries
          description: The countries the institution belongs to
          required: false
          type: array
          items:
            type: string
        - in: query
          name: products_supported
          description: The products that this institution supports
          required: false
          type: string
        - in: query
          name: institution_type
          description: The type of institution
          required: false
          type: string
          enum: *INSTITUTION_TYPE
      tags:
        - customer

  /institutions/customer:
    get:
      description: Get a customer-specific list of institutions for Finverse Link
      operationId: getInstitutionsForCustomer
      security:
        - Oauth2: [institution:link]
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/ListInstitutionsResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /identity:
    get:
      description: \[BETA] Get a list of identity data for a given login identity
      operationId: getIdentity
      security:
        - Oauth2: [identity]
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/GetIdentityResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - login_identity

  /payment_links/confirm:
    post:
      description: Confirm a payment against a payment Link
      operationId: confirmPayment
      security:
        - Oauth2: [payment:confirm] # This scope will be set by payment-link svc in the mandate token
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/ConfirmPaymentResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_links:
    post:
      description: Create payment link
      operationId: CreatePaymentLink
      security:
        - Oauth2: [paymentlink:create]
      parameters:
        - in: body
          name: createPaymentLinkRequest
          description: Parameters required to create a payment link
          schema:
            $ref: "#/definitions/CreatePaymentLinkRequest"
          required: true
      responses:
        200:
          description: Success
          schema:
            $ref: "#/definitions/PaymentLinkResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_links/{paymentLinkId}:
    get:
      description: Get payment link
      operationId: GetPaymentLink
      security:
        - Oauth2: [paymentlink:get]
      parameters:
        - in: path
          required: true
          name: paymentLinkId
          description: The payment link id
          type: string
          minLength: 1
      produces:
        - application/json
      responses:
        200:
          description: Success
          schema:
            $ref: "#/definitions/PaymentLinkResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_links/{paymentLinkId}/cancel:
    post:
      description: Cancel a payment link
      operationId: CancelPaymentLink
      security:
        - Oauth2: [paymentlink:cancel]
      parameters:
        - in: path
          required: true
          name: paymentLinkId
          description: The payment link id
          type: string
          minLength: 1
      produces:
        - application/json
      responses:
        200:
          description: Success
          schema:
            $ref: "#/definitions/PaymentLinkResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_links/kcp/payment:
    post:
      description: Complete a KCP payment
      operationId: completeKcpPayment
      security: 
        - Oauth2: [kcp:completePayment]
      parameters:
        - in: body
          name: completeKcpPaymentRequest
          description: Parameters from the KCP SDK callback to complete the payment
          required: true
          schema:
            $ref: "#/definitions/CompleteKcpPaymentRequest"
      responses:
        200:
          description: Success
          schema:
            $ref: "#/definitions/CompleteKcpPaymentResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /link:
    post:
      description: Create a new link and submit credentials
      operationId: createLink
      security:
        - Oauth2: [linkApi:create]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: apiLinkRequest
          description: Request body for creating a new link and submitting credentials
          required: true
          schema:
            $ref: "#/definitions/ApiLinkRequest"
      responses:
        "200":
          description: ok
          schema:
            $ref: "#/definitions/GetLoginIdentityByIdResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModel"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModel"
      tags:
        - link

  /link/woauth:
    post:
      description: Creates a new link
      operationId: createLinkWoauth
      security:
        - Oauth2: [link]
      produces:
        - application/json
      responses:
        "200":
          description: Service Okay
          schema:
            $ref: "#/definitions/LinkResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModel"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/BadRequestModel"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrorResponse"
      parameters:
        - in: body
          name: linkRequest
          description: Request body for starting a new Link
          required: true
          schema:
            $ref: "#/definitions/LinkRequest"
      tags:
        - link

  /link/token:
    post:
      description: generate a link token that can be used to create link
      operationId: generateLinkToken
      security:
        - Oauth2: [link:token]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: linkTokenRequest
          description: token request
          required: true
          schema:
            $ref: "#/definitions/LinkTokenRequest"
      responses:
        "200":
          description: ok
          schema:
            $ref: "#/definitions/LinkTokenResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - customer
        - login_identity

  /link/relink:
    post:
      description: Update an existing link
      operationId: relink
      security:
        - Oauth2: [loginIdentity:update]
      produces:
        - application/json
      responses:
        "200":
          description: Service Okay
          schema:
            $ref: "#/definitions/LinkResponse"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/BadRequestModel"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/BadRequestModel"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrorResponse"
      parameters:
        - in: body
          name: relinkRequest
          description: Request body for updating Link
          required: true
          schema:
            $ref: "#/definitions/RelinkRequest"
      tags:
        - link

  /link/relink/{loginIdentityId}:
    post:
      description: Create a new link using an existing LIID
      operationId: relinkV2
      security:
        - Oauth2: [relinkApi:create]
      produces:
        - application/json
      responses:
        "200":
          description: Service Okay
          schema:
            $ref: "#/definitions/GetLoginIdentityByIdResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModel"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModel"
      parameters:
        - in: path
          required: true
          name: loginIdentityId
          description: The login identity id
          type: string
        - in: body
          name: apiRelinkRequest
          description: Request body for relinking and submitting credentials
          required: true
          schema:
            $ref: "#/definitions/ApiRelinkRequest"
      tags:
        - link

  /link/action/{loginIdentityId}:
    post:
      description: Post the user action value
      operationId: linkAction
      security:
        - Oauth2: [linkApi:update]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          required: true
          name: loginIdentityId
          description: The login identity id
          type: string
        - in: body
          required: true
          name: actionRequest
          description: Request body for post link action
          schema:
            $ref: "#/definitions/ActionRequest"
      responses:
        "200":
          description: Service Okay
          schema:
            $ref: "#/definitions/GetLoginIdentityByIdResponse"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModel"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModel"
      tags:
        - link

  /link/status/{loginIdentityId}:
    get:
      description: Check the status of a given loginIdentity
      operationId: linkStatus
      security:
        - Oauth2: [linkApi:read]
      produces:
        - application/json
      parameters:
        - in: path
          name: loginIdentityId
          description: The login identity id
          required: true
          type: string
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/LinkStatusResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModel"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModel"
      tags:
        - link

  /link/fvlink/status/{loginIdentityId}:
    get:
      description: Check the status of a given login identity via FVLink
      operationId: linkStatusNonSensitive
      security:
        - Oauth2: [fvLinkStatus:read]
      produces:
        - application/json
      parameters:
        - in: path
          name: loginIdentityId
          description: The login identity id
          required: true
          type: string
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/NonSensitiveLinkStatusResponse"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModel"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModel"
      tags:
        - link

  /auth/callback:
    get:
      description: Callback url to get the oauth authorization token
      operationId: authCallback
      security: []
      produces:
        - application/json
      responses:
        "200":
          description: Returns the redirect uri with either sucess or error
          schema:
            $ref: "#/definitions/RedirectUriResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrorResponse"
        "422":
          description: Unprocessable Entity
          schema:
            $ref: "#/definitions/ErrorResponse"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrorResponse"
      parameters:
        - in: query
          name: state
          description: The state of the client when oauth was initialized
          required: true
          type: string
        - in: query
          name: code
          description: The authorization code generated by the Oauth provider
          type: string
        - in: query
          name: error
          description: error
          type: string
        - in: query
          name: error_description
          description: error description
          type: string
        - in: query
          name: error_details
          description: error details
          type: string
      tags:
        - public

  /auth/token:
    post:
      description: Exchange authorization code for token
      operationId: token
      security:
        - Oauth2: [loginIdentity:token]
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      responses:
        "200":
          description: Service Okay
          schema:
            $ref: "#/definitions/AccessTokenResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: formData
          name: grant_type
          required: true
          type: string
          enum: ["authorization_code"]
        - in: formData
          name: code
          required: true
          type: string
        - in: formData
          name: client_id
          required: true
          type: string
        - in: formData
          name: redirect_uri
          required: true
          type: string
      tags:
        - link

  /auth/token/refresh:
    post:
      description: Refresh an access token
      operationId: refreshToken
      security:
        - Oauth2: [loginIdentity:token]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: refreshRequest
          description: "The refresh token"
          schema:
            $ref: "#/definitions/RefreshRequest"
          required: true
      responses:
        200:
          description: New refresh, access token
          schema:
            $ref: "#/definitions/AccessTokenResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - customer

  /login_identity/{loginIdentityId}:
    get:
      description: Get a specific loginIdentity
      operationId: getLoginIdentityById
      security:
        - Oauth2: [loginIdentity:get]
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/GetLoginIdentityByIdResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: loginIdentityId
          description: The login identity id
          required: true
          type: string
      tags:
        - customer

  /login_identity/{loginIdentityId}/history:
    get:
      description: Get a history of events for a specific loginIdentity
      operationId: getLoginIdentityHistory
      security:
        - Oauth2: [loginIdentity:get]
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/GetLoginIdentityHistoryResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: loginIdentityId
          description: The login identity id
          required: true
          type: string
      tags:
        - customer

  /login_identity:
    get:
      description: Get a specific loginIdentity
      operationId: getLoginIdentity
      security:
        - Oauth2: [loginIdentity:self]
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/GetLoginIdentityByIdResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - login_identity

    delete:
      description: Delete a specific loginIdentity
      operationId: deleteLoginIdentity
      security:
        - Oauth2: [loginIdentity:delete]
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/DeleteLoginIdentityResponse"
        "400":
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - login_identity

  /login_identity/refresh:
    post:
      description: Create a refresh job for a login identity
      operationId: refreshLoginIdentity
      security:
        - Oauth2: [loginIdentity:update]
      produces:
        - application/json
      parameters:
        - in: body
          name: refreshLoginIdentityReq
          schema:
            $ref: "#/definitions/RefreshLoginIdentityRequest"
      responses:
        200:
          description: Refresh queued
          schema:
            $ref: "#/definitions/RefreshTokenResponse"
        400:
          description: Refresh error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - login_identity

  /statements:
    get:
      description: Get list of available statements
      operationId: getStatements
      security:
        - Oauth2: [statement:read]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetStatementsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      tags:
        - login_identity

  /statements/{statementId}:
    get:
      description: Download statement
      operationId: getStatement
      security:
        - Oauth2: [statement:read]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetStatementLinkResponse"
        "307":
          description: Redirect
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: path
          name: statementId
          description: The statement id
          required: true
          type: string
        - in: query
          name: redirect
          description: when true, response will be http redirect; otherwise it will be json response with the download link
          required: false
          type: boolean
          default: true
      tags:
        - login_identity

  /composite_statement:
    get:
      description: Download composite statement
      operationId: getCompositeStatement
      security:
        - Oauth2: [composite_statement]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/CompositeStatementLink"
        "307":
          description: Redirect
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/BadRequestModelV2"
      parameters:
        - in: query
          name: redirect
          description: when true, response will be http redirect; otherwise it will be json response with the download link
          required: false
          type: boolean
          default: true
      tags:
        - login_identity

  /payments/jwks:
    get:
      description: get payment jwks
      operationId: getPaymentsJwks
      security: []
      produces:
        - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: "#/definitions/GetJWKSResponse"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - public

  /payment_users/{paymentUserId}/payment_methods:
    get:
      description: List Payment Methods for a User
      operationId: listPaymentMethods
      security:
        - Oauth2: [payment_method:list]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: '#/definitions/ListPaymentMethodsResponse'
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"       
      parameters:
        - in: path
          name: paymentUserId
          description: Payment User Id
          required: true
          type: string
    post:
      description: Create a Payment Method for a user
      operationId: createPaymentMethod
      security:
        - Oauth2: [paymentMethod:create]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: path
          name: paymentUserId
          description: Payment User ID
          required: true
          type: string
        - in: body
          name: createPaymentMethodRequest
          required: true
          schema:
            $ref: '#/definitions/CreatePaymentMethodRequest'
      responses:
        200:
          description: Success
          schema:
            $ref: '#/definitions/PaymentMethodResponse'
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"        
      
  
  /mandates:
    post:
      description: CREATE Mandate
      operationId: createMandate
      security:
        - Oauth2: [mandate:create]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: header
          name: Idempotency-Key
          type: string
          description: A random key provided by the customer, per unique payment. The purpose for the Idempotency key is to allow safe retrying without the operation being performed multiple times.
        - in: body
          name: createMandateRequest
          description: request body for creating mandate
          schema:
            $ref: "#/definitions/CreateMandateRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/CreateMandateResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer
    get:
      description: List mandates
      operationId: listMandates
      security:
        - Oauth2: [mandate:list]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListMandatesResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: query
          name: date_from
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: date_to
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: statuses
          type: array
          items:
            type: string
            enum: *MANDATE_STATUS
          description: The mandate statuses to filter for, comma separated
        - in: query
          name: sender_type
          type: string
          description: The sender type of the mandate
          enum: *SENDER_TYPE
        - in: query
          name: user_id
          type: string
          description: The user_id the mandate was setup for
        - in: query
          name: institution_id
          type: string
          description: The institution the mandate was executed against
        - in: query
          name: offset
          description: default is 0
          required: false
          type: integer
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          required: false
          type: integer
          default: 500
          minimum: 1
          maximum: 1000

  /mandates/details:
    get:
      description: List mandates details
      operationId: listDetokenizedMandates
      security:
        - Oauth2: [mandate:listSensitive]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListMandatesResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: query
          name: date_from
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: date_to
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: statuses
          type: array
          items:
            type: string
            enum: *MANDATE_STATUS
          description: The mandate statuses to filter for, comma separated
        - in: query
          name: sender_type
          type: string
          description: The sender type of the mandate
          enum: *SENDER_TYPE
        - in: query
          name: user_id
          type: string
          description: The user_id the mandate was setup for
        - in: query
          name: institution_id
          type: string
          description: The institution the mandate was executed against
        - in: query
          name: offset
          description: default is 0
          required: false
          type: integer
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          required: false
          type: integer
          default: 500
          minimum: 1
          maximum: 1000


  /mandates/institution_selection:
    post:
      description: Update InstitutionID and SenderType for Mandate
      operationId: setMandateInstitution
      security:
        - Oauth2: [mandate_auth:update]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: updateRequest
          description: request body for updating mandate institutionId and senderType
          schema:
            $ref: "#/definitions/SetMandateInstitutionRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/SetMandateInstitutionResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer

  /mandates/{mandateId}:
    get:
      description: Get Mandate details by mandate_id
      operationId: getMandate
      security:
        - Oauth2: [mandate:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetMandateResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: mandateId
          description: mandate id
          required: true
          type: string
      tags:
        - customer

  /mandates/link:
    post:
      description: Get link to launch FV Link UI in mandate authorization mode
      operationId: getMandateAuthLink
      security:
        - Oauth2: [mandate:create]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetMandateAuthLinkResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: body
          name: getMandateAuthLinkRequest
          description: request body for mandate authorization link
          schema:
            $ref: "#/definitions/GetMandateAuthLinkRequest"
          required: true
      tags:
        - customer

  /mandates/sender_account:
    post:
      description: Create mandate for an existing sender account
      operationId: createMandateForExistingSender
      security:
        - Oauth2: [mandate:create]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: header
          name: Idempotency-Key
          type: string
          description: A random key provided by the customer, per unique payment. The purpose for the Idempotency key is to allow safe retrying without the operation being performed multiple times.
          required: true
        - in: body
          name: createMandateRequest
          description: request body for creating mandate
          schema:
            $ref: "#/definitions/CreateMandateWithSenderAccountRequest"
          required: true
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/CreateMandateResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payments:
    post:
      description: Create new Payment
      operationId: createPayment
      security:
        - Oauth2: [payment:create]
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: header
          name: Idempotency-Key
          type: string
          description: A random key provided by the customer, per unique payment. The purpose for the Idempotency key is to allow safe retrying without the operation being performed multiple times.
        - in: body
          name: createPaymentRequest
          description: request body for creating payment
          schema:
            $ref: "#/definitions/CreatePaymentRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/PaymentResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer
    get:
      description: List Payments
      operationId: listPayments
      security:
        - Oauth2: [payment:list]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListPaymentsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: query
          name: date_from
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: date_to
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: statuses
          type: array
          items:
            type: string
            enum: *PAYMENT_STATUS
          description: The payment statuses to filter for, comma separated
        - in: query
          name: sender_type
          type: string
          description: The sender type of the mandate
          enum: *SENDER_TYPE
        - in: query
          name: user_id
          type: string
          description: The user_id the mandate was setup for
        - in: query
          name: institution_id
          type: string
          description: The institution the mandate was executed against
        - in: query
          name: payment_type
          type: string
          enum: *PAYMENT_TYPE
          description: Deprecated - The type of payment
        - in: query
          name: payment_types
          type: array
          items:
            type: string
            enum: *PAYMENT_TYPE
        - in: query
          name: mandate_id
          type: string
          description: The mandate the payment belongs to
        - in: query
          name: currency
          type: string
          description: Deprecated - The currency the payment is made in
        - in: query
          name: currencies
          type: array
          items:
            type: string
        - in: query
          name: offset
          description: default is 0
          required: false
          type: integer
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          required: false
          type: integer
          default: 500
          minimum: 1
          maximum: 1000

  /payments/{paymentId}:
    get:
      description: Get Payment details by payment_id
      operationId: getPayment
      security:
        - Oauth2: [payment:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/PaymentResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: paymentId
          description: payment id
          required: true
          type: string
      tags:
        - customer
    post:
      description: Update payment
      operationId: updatePayment
      security:
        - Oauth2: [payment:update]
      produces:
        - application/json
      parameters:
        - in: path
          name: paymentId
          description: payment id
          required: true
          type: string
        - in: body
          name: updatePaymentRequest
          description: request body for updating payment
          schema:
            $ref: "#/definitions/UpdatePaymentRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/PaymentResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer

  /mandates/auth:
    get:
      description: Get Mandate Authorization by mandate id
      operationId: getMandateAuth
      # Need to update this to the proper scope
      security:
        - Oauth2: [mandate_auth:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetMandateAuthResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer

    post:
      description: Submit authorization checklist items
      operationId: submitAuthChecklist
      # Need to update this to the proper scope
      security:
        - Oauth2: [mandate_auth:update]
      produces:
        - application/json
      parameters:
        - in: body
          name: submitAuthChecklistRequest
          description: request body for submitting auth checklist
          schema:
            $ref: "#/definitions/SubmitAuthChecklistRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/SubmitAuthChecklistResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer

  /mandates/{mandateId}/authorize:
    post:
      description: Allows a customer to authorize a specific mandate
      operationId: authorizeMandate
      # Need to update this to the proper scope
      security:
        - Oauth2: [mandates:authorize]
      produces:
        - application/json
      parameters:
        - in: path
          name: mandateId
          description: The mandate_id that is being authorized
          required: true
          type: string
        - in: body
          name: authorizeMandateRequest
          description: request body for authorizing a mandate
          schema:
            $ref: "#/definitions/AuthorizeMandateRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetMandateResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer

  /payments/instruction:
    post:
      description: Create a new payment instruction to be used when linking to perform new payment
      operationId: createPaymentInstruction
      security:
        - Oauth2: [payment:create]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/CreatePaymentInstructionResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModel"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/BadRequestModel"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrorResponse"
      parameters:
        - in: body
          name: paymentInstruction
          description: Request body for starting a new Link
          required: true
          schema:
            $ref: "#/definitions/CustomerPaymentInstruction"
      tags:
        - customer

  /testing/payments/{paymentId}/status:
    post:
      description: Update the status of a test manual payment
      operationId: updateTestPaymentStatus
      security:
        - Oauth2: [testPayment:update]
      produces:
        - application/json
      responses:
        200:
          description: Successful
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: paymentId
          description: The test payment ID
          required: true
          type: string
        - in: body
          name: paymentStatus
          description: Request body for updating the test manual payment status
          required: true
          schema:
            $ref: "#/definitions/UpdateTestPaymentStatusRequest"
      tags:
        - customer

  /payments/instruction/{paymentInstructionId}:
    get:
      description: Get payment instructions by payment_instruction_id
      operationId: getPaymentInstruction
      security:
        - Oauth2: [payment:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetPaymentInstructionsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/BadRequestModel"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/BadRequestModel"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrorResponse"
      parameters:
        - in: path
          name: paymentInstructionId
          description: The id of a payment instruction
          required: true
          type: string
      tags:
        - customer

  /payments/manual_payment:
    post:
      description: Submit manual payment confirmation
      operationId: confirmManualPayment
      security:
        - Oauth2: [manual_payment:confirm] #this scope will be in manual payment token
      produces:
        - application/json
      parameters:
        - in: body
          name: manualPaymentIdentifiers
          description: Request body containing information to identify manual payment
          required: true
          schema:
            $ref: "#/definitions/ManualPaymentConfirmationRequest"
      responses:
        200:
          description: ok
          schema:
            $ref: "#/definitions/ManualPaymentConfirmationResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payouts/scheduled:
    post:
      description: Create a scheduled payout
      operationId: createScheduledPayout
      security:
        - Oauth2: [payout:create]
      produces:
        - application/json
      parameters:
        - in: header
          name: Idempotency-Key
          type: string
          description: A random key provided by the customer, per unique payment. The purpose for the Idempotency key is to allow safe retrying without the operation being performed multiple times.
          required: true
        - in: body
          name: createScheduledPayoutRequest
          description: Request body containing information to create scheduled payout
          required: true
          schema:
            $ref: "#/definitions/CreateScheduledPayoutRequest"
      responses:
        200:
          description: ok
          schema:
            $ref: "#/definitions/PayoutSnapshotResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payouts/{payoutId}:
    get:
      description: Get payout by payout_id
      operationId: getPayoutById
      security:
        - Oauth2: [payout:get]
      produces:
        - application/json
      responses:
        200:
          description: ok
          schema:
            $ref: "#/definitions/PayoutSnapshotResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: payoutId
          description: payout id
          required: true
          type: string

  /payouts:
    get:
      description: List payouts
      operationId: listPayouts
      security:
        - Oauth2: [payout:list]
      produces: 
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/ListPayoutsResponse'
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: query
          name: date_from
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: date_to
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: statuses
          type: array
          items:
            type: string
            enum: *PAYOUT_STATUS
          description: The payout statuses to filter for, comma separated
        - in: query
          name: currencies
          type: array
          items:
            type: string    
        - in: query
          name: payout_types
          type: array
          items:
            type: string
            enum: *PAYOUT_TYPE
        - in: query
          name: mandate_id
          type: string
        - in: query
          name: sender_account_id
          type: string
        - in: query
          name: recipient_account_id
          type: string
        - in: query
          name: recipient_user_id
          type: string
        - in: query
          name: recipient_external_user_id
          type: string                                                    
        - in: query
          name: offset
          type: integer
          description: Default is 0
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          type: integer
          default: 500
          minimum: 1
          maximum: 1000       

  /payouts/{payoutId}/cancel:
    post:
      description: Cancel Payout by payout_id
      operationId: cancelPayout
      security:
        - Oauth2: [payout:cancel]
      produces:
        - application/json
      responses:
        200:
          description: ok
          schema:
            $ref: "#/definitions/PayoutSnapshotResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: payoutId
          description: payout id
          required: true
          type: string

  /payment_links/fps/qr_code:
    get:
      description: Get the FPS QR code
      operationId: getFpsQrCode
      security:
        - Oauth2: [qr_code:get]
      produces:
        - application/json
      responses:
        200:
          description: Success
          schema:
            $ref: "#/definitions/FpsQrCodeResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /calculate/line_items/{paymentType}:
    get:
      description: Get line items for display
      operationId: getLineItemsForDisplay
      security:
        - Oauth2: [line_items:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetLineItemsForDisplayResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: paymentType
          description: The payment type
          required: true
          enum: [MANDATE, MANUAL, CARD]
          type: string
      tags:
        - customer

  /calculate/line_items_v2:
    get:
      description: Get line items for display
      operationId: getLineItemsForDisplayV2
      security:
        - Oauth2: [line_items:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetLineItemsForDisplayResponseV2"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer

  /payment_users/{paymentUserId}/payment_accounts:
    get:
      description: Get payment account by user id
      operationId: listPaymentAccounts
      security:
        - Oauth2: [payment_account:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListPaymentAccountsResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: paymentUserId
          description: The payment user id
          required: true
          type: string
      tags:
        - customer

  /payment_accounts:
    post:
      description: create payment account
      operationId: createPaymentAccount
      security:
        - Oauth2: [payment_account:create]
      produces:
        - application/json
      parameters:
        - in: body
          name: createPaymentAccountRequest
          description: request body for creating payment account
          schema:
            $ref: "#/definitions/CreatePaymentAccountRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/PaymentAccountDetails"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer
    get:
      description: Get payment account for customer app
      operationId: listPaymentAccountsWithEnrichedData
      security:
        - Oauth2: [paymentAccount:list]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/ListPaymentAccountsWithEnrichedDataResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: query
          name: account_type
          type: string
          description: The account_type to filter for
          enum: [EXTERNAL_ACCOUNT, SETTLEMENT_ACCOUNT]
        - in: query
          name: currencies
          type: array
          items:
            type: string
          description: The currencies to filter for
        - in: query
          name: offset
          description: default is 0
          required: false
          type: integer
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          required: false
          type: integer
          default: 500
          minimum: 1
          maximum: 1000
      tags:
        - customer

  /payment_accounts/{paymentAccountId}:
    delete:
      description: delete payment account
      operationId: deletePaymentAccount
      security:
        - Oauth2: [payment_account:delete]
      produces:
        - application/json
      responses:
        200:
          description: Successful
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      parameters:
        - in: path
          name: paymentAccountId
          description: The payment account id
          required: true
          type: string
      tags:
        - customer

  /payment_users:
    post:
      description: Create a payment user
      operationId: createPaymentUser
      security:
        - Oauth2: [payment_user:create]
      produces:
        - application/json
      parameters:
        - in: body
          name: createPaymentUserRequest
          description: request body for creating payment user
          schema:
            $ref: "#/definitions/CreatePaymentUserRequest"
          required: true
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/PaymentUser"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer

  /payment_users/{paymentUserId}:
    get:
      description: Get a payment user
      operationId: getPaymentUser
      security:
        - Oauth2: [payment_user:get]
      produces:
        - application/json
      parameters:
        - in: path
          name: paymentUserId
          required: true
          type: string
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/PaymentUser"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
      tags:
        - customer
    post:
      description: Update a payment user
      operationId: updatePaymentUser
      security:
        - Oauth2: [paymentUser:update]
      produces:
        - application/json
      parameters:
        - in: path
          name: paymentUserId
          required: true
          type: string
        - in: body
          name: updatePaymentUserRequest
          description: request body for updating payment user
          schema:
            $ref: "#/definitions/UpdatePaymentUserRequest"
          required: true
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/PaymentUser"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_methods/{paymentMethodId}:
    get:
      description: Get a payment method
      operationId: getPaymentMethod
      security:
        - Oauth2: [paymentMethod:get]
      produces:
        - application/json
      parameters:
        - in: path
          name: paymentMethodId
          required: true
          type: string
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/PaymentMethodResponse'
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_link/fvlink/payment_user/sender:
    get:
      description: Get sender payment user in payment link flow
      operationId: getSenderPaymentUser
      security:
        - Oauth2: [payment_links:payment_user:get] # Will be set in payment link token (in payment links svc)
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/GetPaymentUserResponse"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_link/fvlink/payment_user/autopay:
    post:
      description: Set autopay consent for payment user
      operationId: setAutopayConsent
      security:
        - Oauth2: [paymentLink:paymentUser:setAutopayConsent] # Will be set in payment link token (in payment links svc)
      produces:
        - application/json
      parameters:
        - in: body
          name: setAutopayConsentRequest
          required: true
          schema:
            $ref: "#/definitions/SetAutopayConsentRequest"
      responses:
        200:
          description: Successful
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_link/fvlink/payment_method:
    get:
      description: Get payment method in payment link flow
      operationId: getPaymentMethodPaymentLink
      security:
        - Oauth2: [payment_links:payment_method:get]
      produces:
        - application/json
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/PaymentMethodFvLinkResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_link/fvlink/payment_method/change:
    post:
      description: Initiate change payment method from payment link front-end
      operationId: changePaymentMethodPaymentLink
      security:
        - Oauth2: [payment_links:payment_method:update]
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/ChangePaymentMethodFvLinkResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_link/fvlink/payment_attempt/refresh:
    post:
      description: Refresh payment attempt from payment link front-end
      operationId: refreshPaymentAttempt
      security:
        - Oauth2: [payment_attempt:refresh]
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/RefreshPaymentAttemptResponse"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_link/fvlink/payment:
    get:
      description: Get payment (if exists) on the payment link for front-end
      operationId: getPaymentPaymentLink
      security:
        - Oauth2: [paymentLinks:payment:get]
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/PaymentFvLinkResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
    
  /payment_link/fvlink/payment_attempt/demote:
    post:
      description: Demote payment attempt
      operationId: demotePaymentAttempt
      security:
        - Oauth2: ['paymentLinks:paymentAttempt:demote']
      produces:
        - application/json
      responses:
        200:
          description: ok
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_link/fvlink/available_payment_methods:
    get:
      description: List available payment methods
      operationId: listAvailablePaymentMethodsPaymentLink
      security:
        - Oauth2: ['paymentLink:availablePaymentMethod:list']
      produces:
        - application/json
      responses:
        200:
          description: ok
          schema:
            $ref: "#/definitions/AvailablePaymentMethodsFvLinkResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /payment_links/fvlink/select_payment_method:
    post:
      description: Select a payment method for payment link
      operationId: selectPaymentMethodPaymentLink
      security:
        - Oauth2: ['paymentLink:paymentMethod:select']
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: selectPaymentMethodRequest
          description: request body for selecting a payment method
          schema:
            $ref: "#/definitions/SelectPaymentMethodRequest"
          required: true
      responses:
        200:
          description: Successful
          schema:
            $ref: "#/definitions/SelectPaymentMethodResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

  /ledger/statement:
    get:
      description: Download the balance statement for the ledger (CSV)
      operationId: downloadBalanceStatement
      security:
        - Oauth2: [ledger:statement]
      produces:
        - application/json
      parameters:
        - in: query
          name: date_from
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: date_to
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: currencies
          type: array
          items:
            type: string
          description: The currencies to filter for
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/DownloadBalanceStatementResponse"
        400:
          description: Bad Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"      
    
  /disputes:
    get:
      description: List Disputes
      operationId: listDisputes
      security:
        - Oauth2: [dispute:list]
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema: 
            $ref: "#/definitions/ListDisputesResponse"
        400:
          description: Invalid Request
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/ErrBodyModelV2"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ErrBodyModelV2"

      parameters:
        - in: query
          name: date_from
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: date_to
          type: string
          format: date
          description: ISO format (YYYY-MM-DD)
        - in: query
          name: statuses
          type: array
          items:
            type: string
            enum: *DISPUTE_STATUS
          description: The dispute statuses to filter for, comma separated
        - in: query
          name: offset
          description: default is 0
          required: false
          type: integer
          default: 0
          minimum: 0
        - in: query
          name: limit
          description: default is 500, max is 1000
          required: false
          type: integer
          default: 500
          minimum: 1
          maximum: 1000
